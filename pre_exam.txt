Sun Jan 19 22:40:58 CET 2025
+ hostname
Drew
+ ansible-playbook infra.yaml --diff
[WARNING]: While constructing a mapping from
/home/daayso/ica0002/ica0002/roles/agama/tasks/main.yaml, line 27, column 5,
found a duplicate dict key (state). Using last defined value only.
[WARNING]: While constructing a mapping from
/home/daayso/ica0002/ica0002/roles/agama/tasks/main.yaml, line 42, column 5,
found a duplicate dict key (state). Using last defined value only.
 ______________________
< PLAY [Initial setup] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

[WARNING]: Platform linux on host davidayson8-2 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
[WARNING]: Platform linux on host davidayson8-3 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
[WARNING]: Platform linux on host davidayson8-1 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 ________________________________
< TASK [init : Update APT cache] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
changed: [davidayson8-3]
 _______________________________________
< TASK [init : Install Prometheus node] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  libio-pty-perl libipc-run-perl libtime-duration-perl libtimedate-perl
  moreutils prometheus-node-exporter-collectors smartmontools
Suggested packages:
  gsmartcontrol smart-notifier mailx | mailutils
The following NEW packages will be installed:
  libio-pty-perl libipc-run-perl libtime-duration-perl libtimedate-perl
  moreutils prometheus-node-exporter prometheus-node-exporter-collectors
  smartmontools
0 upgraded, 8 newly installed, 0 to remove and 134 not upgraded.
changed: [davidayson8-1]
The following additional packages will be installed:
  libio-pty-perl libipc-run-perl libtime-duration-perl libtimedate-perl
  moreutils prometheus-node-exporter-collectors smartmontools
Suggested packages:
  gsmartcontrol smart-notifier mailx | mailutils
The following NEW packages will be installed:
  libio-pty-perl libipc-run-perl libtime-duration-perl libtimedate-perl
  moreutils prometheus-node-exporter prometheus-node-exporter-collectors
  smartmontools
0 upgraded, 8 newly installed, 0 to remove and 134 not upgraded.
changed: [davidayson8-2]
The following additional packages will be installed:
  libio-pty-perl libipc-run-perl libtime-duration-perl libtimedate-perl
  moreutils prometheus-node-exporter-collectors smartmontools
Suggested packages:
  gsmartcontrol smart-notifier mailx | mailutils
The following NEW packages will be installed:
  libio-pty-perl libipc-run-perl libtime-duration-perl libtimedate-perl
  moreutils prometheus-node-exporter prometheus-node-exporter-collectors
  smartmontools
0 upgraded, 8 newly installed, 0 to remove and 134 not upgraded.
changed: [davidayson8-3]
 ____________________________________
< TASK [init : Run Rsyslog template] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpntxbx4qi/rsyslog.conf
@@ -0,0 +1,8 @@
+$ActionQueueType LinkedList # use asynchronous processing
+$ActionQueueFileName srvrfwd # set file name, also enables disk mode
+$ActionResumeRetryCount -1 # infinite retries on insert failure
+$ActionQueueSaveOnShutdown on # save in-memory data if rsyslog shuts down
+$ModLoad imudp #loads the udp module  
+$UDPServerAddress localhost 
+$UDPServerRun 514 
+*.* @influxdb:6514;RSYSLOG_SyslogProtocol23Format

changed: [davidayson8-1]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp6o3e2bcf/rsyslog.conf
@@ -0,0 +1,8 @@
+$ActionQueueType LinkedList # use asynchronous processing
+$ActionQueueFileName srvrfwd # set file name, also enables disk mode
+$ActionResumeRetryCount -1 # infinite retries on insert failure
+$ActionQueueSaveOnShutdown on # save in-memory data if rsyslog shuts down
+$ModLoad imudp #loads the udp module  
+$UDPServerAddress localhost 
+$UDPServerRun 514 
+*.* @influxdb:6514;RSYSLOG_SyslogProtocol23Format

changed: [davidayson8-2]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpjpi4b0jm/rsyslog.conf
@@ -0,0 +1,8 @@
+$ActionQueueType LinkedList # use asynchronous processing
+$ActionQueueFileName srvrfwd # set file name, also enables disk mode
+$ActionResumeRetryCount -1 # infinite retries on insert failure
+$ActionQueueSaveOnShutdown on # save in-memory data if rsyslog shuts down
+$ModLoad imudp #loads the udp module  
+$UDPServerAddress localhost 
+$UDPServerRun 514 
+*.* @influxdb:6514;RSYSLOG_SyslogProtocol23Format

changed: [davidayson8-3]
 __________________________________
< TASK [init : Create backup user] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
changed: [davidayson8-1]
changed: [davidayson8-2]
 ____________________________________
< TASK [init : Generate SSH keypair] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-3]
changed: [davidayson8-1]
 ____________________________________________________________
< TASK [init : Ensure .ssh directory exists for backup user] >
 ------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
ok: [davidayson8-3]
 _______________________________________________________
/ TASK [init : Add backup server key to known_hosts for \
\ backup user]                                          /
 -------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpvupdod2w/known_hosts.j2
@@ -0,0 +1,4 @@
+192.168.42.132 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+backup ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+backup.daayso.da ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+

changed: [davidayson8-1]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpp693oo72/known_hosts.j2
@@ -0,0 +1,4 @@
+192.168.42.132 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+backup ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+backup.daayso.da ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+

changed: [davidayson8-2]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpx8sucb2w/known_hosts.j2
@@ -0,0 +1,4 @@
+192.168.42.132 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+backup ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+backup.daayso.da ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIEu6pFFWyuRrl4WGFPQGElYN9txwTGm2wSntcpVAaN90
+

changed: [davidayson8-3]
 _____________________________________________
< TASK [init : Make Backup owner of INIT DIR] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,7 +1,7 @@
 {
-    "group": 0,
-    "mode": "0755",
-    "owner": 0,
+    "group": 34,
+    "mode": "0744",
+    "owner": 34,
     "path": "/home/backup/restore",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-1]
--- before
+++ after
@@ -1,7 +1,7 @@
 {
-    "group": 0,
-    "mode": "0755",
-    "owner": 0,
+    "group": 34,
+    "mode": "0744",
+    "owner": 34,
     "path": "/home/backup/restore",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-2]
--- before
+++ after
@@ -1,7 +1,7 @@
 {
-    "group": 0,
-    "mode": "0755",
-    "owner": 0,
+    "group": 34,
+    "mode": "0744",
+    "owner": 34,
     "path": "/home/backup/restore",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-3]
 _________________________________
< TASK [init : Install Duplicity] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  librsync2 python3-fasteners python3-future python3-lockfile
  python3-monotonic python3-nacl python3-paramiko
Suggested packages:
  python3-boto ncftp lftp tahoe-lafs python3-swiftclient python3-pip par2
  python-future-doc python-lockfile-doc python-nacl-doc python3-gssapi
  python3-invoke
The following NEW packages will be installed:
  duplicity librsync2 python3-fasteners python3-future python3-lockfile
  python3-monotonic python3-nacl python3-paramiko
0 upgraded, 8 newly installed, 0 to remove and 134 not upgraded.
changed: [davidayson8-1]
The following additional packages will be installed:
  librsync2 python3-fasteners python3-future python3-lockfile
  python3-monotonic python3-nacl python3-paramiko
Suggested packages:
  python3-boto ncftp lftp tahoe-lafs python3-swiftclient python3-pip par2
  python-future-doc python-lockfile-doc python-nacl-doc python3-gssapi
  python3-invoke
The following NEW packages will be installed:
  duplicity librsync2 python3-fasteners python3-future python3-lockfile
  python3-monotonic python3-nacl python3-paramiko
0 upgraded, 8 newly installed, 0 to remove and 134 not upgraded.
changed: [davidayson8-2]
The following additional packages will be installed:
  librsync2 python3-fasteners python3-future python3-lockfile
  python3-monotonic python3-nacl python3-paramiko
Suggested packages:
  python3-boto ncftp lftp tahoe-lafs python3-swiftclient python3-pip par2
  python-future-doc python-lockfile-doc python-nacl-doc python3-gssapi
  python3-invoke
The following NEW packages will be installed:
  duplicity librsync2 python3-fasteners python3-future python3-lockfile
  python3-monotonic python3-nacl python3-paramiko
0 upgraded, 8 newly installed, 0 to remove and 134 not upgraded.
changed: [davidayson8-3]
 __________________________________________
< RUNNING HANDLER [init : Restart Rsyslog] >
 ------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
changed: [davidayson8-2]
changed: [davidayson8-1]
 _________________________
< PLAY [host DNS servers] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 _____________________________
< TASK [bind : Install Bind9] >
 -----------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  bind9-dnsutils bind9-host bind9-libs bind9-utils dns-root-data
Suggested packages:
  bind-doc resolvconf
The following NEW packages will be installed:
  bind9 bind9-utils dns-root-data
The following packages will be upgraded:
  bind9-dnsutils bind9-host bind9-libs
3 upgraded, 3 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
The following additional packages will be installed:
  bind9-dnsutils bind9-host bind9-libs bind9-utils dns-root-data
Suggested packages:
  bind-doc resolvconf
The following NEW packages will be installed:
  bind9 bind9-utils dns-root-data
The following packages will be upgraded:
  bind9-dnsutils bind9-host bind9-libs
3 upgraded, 3 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-3]
The following additional packages will be installed:
  bind9-dnsutils bind9-host bind9-libs bind9-utils dns-root-data
Suggested packages:
  bind-doc resolvconf
The following NEW packages will be installed:
  bind9 bind9-utils dns-root-data
The following packages will be upgraded:
  bind9-dnsutils bind9-host bind9-libs
3 upgraded, 3 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
 ___________________________________________________
< TASK [bind : Configure named.conf files Template] >
 ---------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3] => (item=None)
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-1] => (item=None)
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2]
changed: [davidayson8-3] => (item=None)
changed: [davidayson8-3]
changed: [davidayson8-1] => (item=None)
changed: [davidayson8-1]
 _________________________________
< TASK [bind : Run Zone template] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
changed: [davidayson8-1]
changed: [davidayson8-2]
 _________________________________________
< TASK [bind : Run Reverse Zone template] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1]
skipping: [davidayson8-2]
changed: [davidayson8-3]
 _______________________________________________
< TASK [bind : Install dependency for nsupdate] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  python3-requests-toolbelt
Suggested packages:
  python3-sniffio python3-trio
The following NEW packages will be installed:
  python3-dnspython python3-requests-toolbelt
0 upgraded, 2 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
The following additional packages will be installed:
  python3-requests-toolbelt
Suggested packages:
  python3-sniffio python3-trio
The following NEW packages will be installed:
  python3-dnspython python3-requests-toolbelt
0 upgraded, 2 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-3]
The following additional packages will be installed:
  python3-requests-toolbelt
Suggested packages:
  python3-sniffio python3-trio
The following NEW packages will be installed:
  python3-dnspython python3-requests-toolbelt
0 upgraded, 2 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________________
< RUNNING HANDLER [bind : Reload Bind9] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-3]
changed: [davidayson8-2]
 ________________________________________
< RUNNING HANDLER [bind : Restart Bind9] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
changed: [davidayson8-1]
changed: [davidayson8-2]
 _________________________________________
< RUNNING HANDLER [bind : Reload systemd] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________________________
< TASK [bind : Add backup record on backup DNS servers] >
 -------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 ___________________________________________________________
< TASK [bind : Ensure Bind9 service is started and running] >
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________
< TASK [bind : Create bind_exporter user] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-3]
changed: [davidayson8-1]
 _______________________________________
< TASK [bind : Download Bind9 exporter] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
changed: [davidayson8-3]
 __________________________________________________
< TASK [bind : Create directory for Bind Exporter] >
 --------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/bind_exporter",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-1]
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/bind_exporter",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-2]
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/bind_exporter",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-3]
 ______________________________________
< TASK [bind : Extract Bind9 exporter] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-3]
changed: [davidayson8-2]
 _____________________________________________________
/ TASK [bind : Create a symlink for the Bind Exporter \
\ executable]                                         /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/usr/local/bin/prometheus-bind-exporter",
-    "state": "absent"
+    "state": "link"
 }

changed: [davidayson8-1]
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/usr/local/bin/prometheus-bind-exporter",
-    "state": "absent"
+    "state": "link"
 }

changed: [davidayson8-2]
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/usr/local/bin/prometheus-bind-exporter",
-    "state": "absent"
+    "state": "link"
 }

changed: [davidayson8-3]
 _____________________________________________________
< TASK [bind : Create Bind9 exporter systemd service] >
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp9ej78b9x/bind_exporter.service
@@ -0,0 +1,13 @@
+[Unit]
+Description=Bind Exporter
+After=network.target
+
+[Service]
+Type=simple
+ExecStart=/usr/local/bin/prometheus-bind-exporter --web.listen-address=":9119"
+User=bind_exporter
+Group=bind_exporter
+Restart=always
+
+[Install]
+WantedBy=multi-user.target

changed: [davidayson8-1]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmplgfnadc7/bind_exporter.service
@@ -0,0 +1,13 @@
+[Unit]
+Description=Bind Exporter
+After=network.target
+
+[Service]
+Type=simple
+ExecStart=/usr/local/bin/prometheus-bind-exporter --web.listen-address=":9119"
+User=bind_exporter
+Group=bind_exporter
+Restart=always
+
+[Install]
+WantedBy=multi-user.target

changed: [davidayson8-2]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpg_7c0y07/bind_exporter.service
@@ -0,0 +1,13 @@
+[Unit]
+Description=Bind Exporter
+After=network.target
+
+[Service]
+Type=simple
+ExecStart=/usr/local/bin/prometheus-bind-exporter --web.listen-address=":9119"
+User=bind_exporter
+Group=bind_exporter
+Restart=always
+
+[Install]
+WantedBy=multi-user.target

changed: [davidayson8-3]
 ___________________________________________________________
/ TASK [bind : Ensure Bind9 exporter service is started and \
\ running]                                                  /
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
changed: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3, davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
changed: [davidayson8-3]
 ___________________________________________
< RUNNING HANDLER [bind : Restart Exporter] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
changed: [davidayson8-3]
 _________________________________________
< RUNNING HANDLER [bind : Reload systemd] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
ok: [davidayson8-3]
 _________________________
< PLAY [Setup custom DNS] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
ok: [davidayson8-3]
 ______________________________________
< TASK [resolver : Update resolv.conf] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/resolv.conf
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpaxldfbrn/resolv.conf.j2
@@ -1,23 +1,4 @@
-# This is /run/systemd/resolve/stub-resolv.conf managed by man:systemd-resolved(8).
-# Do not edit.
-#
-# This file might be symlinked as /etc/resolv.conf. If you're looking at
-# /etc/resolv.conf and seeing this text, you have followed the symlink.
-#
-# This is a dynamic resolv.conf file for connecting local clients to the
-# internal DNS stub resolver of systemd-resolved. This file lists all
-# configured search domains.
-#
-# Run "resolvectl status" to see details about the uplink DNS servers
-# currently in use.
-#
-# Third party programs should typically not access this file directly, but only
-# through the symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a
-# different way, replace this symlink by a static file or a different symlink.
-#
-# See man:systemd-resolved.service(8) for details about the supported modes of
-# operation for /etc/resolv.conf.
-
-nameserver 127.0.0.53
-options edns0 trust-ad
-search openstacklocal
+nameserver 192.168.43.151
+nameserver 192.168.43.65
+nameserver 192.168.43.172
+search daayso.da

changed: [davidayson8-1]
--- before: /etc/resolv.conf
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpsmnwenv7/resolv.conf.j2
@@ -1,23 +1,4 @@
-# This is /run/systemd/resolve/stub-resolv.conf managed by man:systemd-resolved(8).
-# Do not edit.
-#
-# This file might be symlinked as /etc/resolv.conf. If you're looking at
-# /etc/resolv.conf and seeing this text, you have followed the symlink.
-#
-# This is a dynamic resolv.conf file for connecting local clients to the
-# internal DNS stub resolver of systemd-resolved. This file lists all
-# configured search domains.
-#
-# Run "resolvectl status" to see details about the uplink DNS servers
-# currently in use.
-#
-# Third party programs should typically not access this file directly, but only
-# through the symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a
-# different way, replace this symlink by a static file or a different symlink.
-#
-# See man:systemd-resolved.service(8) for details about the supported modes of
-# operation for /etc/resolv.conf.
-
-nameserver 127.0.0.53
-options edns0 trust-ad
-search openstacklocal
+nameserver 192.168.43.151
+nameserver 192.168.43.65
+nameserver 192.168.43.172
+search daayso.da

changed: [davidayson8-2]
--- before: /etc/resolv.conf
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpq2kfm33e/resolv.conf.j2
@@ -1,23 +1,4 @@
-# This is /run/systemd/resolve/stub-resolv.conf managed by man:systemd-resolved(8).
-# Do not edit.
-#
-# This file might be symlinked as /etc/resolv.conf. If you're looking at
-# /etc/resolv.conf and seeing this text, you have followed the symlink.
-#
-# This is a dynamic resolv.conf file for connecting local clients to the
-# internal DNS stub resolver of systemd-resolved. This file lists all
-# configured search domains.
-#
-# Run "resolvectl status" to see details about the uplink DNS servers
-# currently in use.
-#
-# Third party programs should typically not access this file directly, but only
-# through the symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a
-# different way, replace this symlink by a static file or a different symlink.
-#
-# See man:systemd-resolved.service(8) for details about the supported modes of
-# operation for /etc/resolv.conf.
-
-nameserver 127.0.0.53
-options edns0 trust-ad
-search openstacklocal
+nameserver 192.168.43.151
+nameserver 192.168.43.65
+nameserver 192.168.43.172
+search daayso.da

changed: [davidayson8-3]
 _______________________________________________
< TASK [resolver : System-resolved is shutdown] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
changed: [davidayson8-3]
 ___________________________
< PLAY [Install Prometheus] >
 ---------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________
< TASK [prometheus : Install Prometheus] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  fonts-glyphicons-halflings javascript-common libjs-bootstrap
  libjs-bootstrap4 libjs-d3 libjs-eonasdan-bootstrap-datetimepicker
  libjs-jquery libjs-jquery-hotkeys libjs-moment libjs-moment-timezone
  libjs-mustache libjs-popper.js libjs-rickshaw libjs-sizzle node-jquery
Suggested packages:
  apache2 | lighttpd | httpd
The following NEW packages will be installed:
  fonts-glyphicons-halflings javascript-common libjs-bootstrap
  libjs-bootstrap4 libjs-d3 libjs-eonasdan-bootstrap-datetimepicker
  libjs-jquery libjs-jquery-hotkeys libjs-moment libjs-moment-timezone
  libjs-mustache libjs-popper.js libjs-rickshaw libjs-sizzle node-jquery
  prometheus
0 upgraded, 16 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-3]
 ________________________________________________________
/ TASK [prometheus : Make sure Prometheus is enabled and \
\ running]                                               /
 --------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________________________
< TASK [prometheus : Run Prometheus config template] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/prometheus/prometheus.yml
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpy5v51mcs/config.yaml.j2
@@ -1,44 +1,61 @@
-# Sample config for Prometheus.
+global:
+  scrape_interval: 5s
+  evaluation_interval: 5s
 
-global:
-  scrape_interval:     15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
-  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
-  # scrape_timeout is set to the global default (10s).
-
-  # Attach these labels to any time series or alerts when communicating with
-  # external systems (federation, remote storage, Alertmanager).
-  external_labels:
-      monitor: 'example'
-
-# Alertmanager configuration
-alerting:
-  alertmanagers:
-  - static_configs:
-    - targets: ['localhost:9093']
-
-# Load rules once and periodically evaluate them according to the global 'evaluation_interval'.
-rule_files:
-  # - "first_rules.yml"
-  # - "second_rules.yml"
-
-# A scrape configuration containing exactly one endpoint to scrape:
-# Here it's Prometheus itself.
 scrape_configs:
-  # The job name is added as a label `job=<job_name>` to any timeseries scraped from this config.
+  - job_name: 'linux'
+    static_configs:
+      - targets:
+                - davidayson8-1:9100
+                - davidayson8-2:9100
+                - davidayson8-3:9100
+        
   - job_name: 'prometheus'
-
-    # Override the global default and scrape targets from this job every 5 seconds.
     scrape_interval: 5s
     scrape_timeout: 5s
-
-    # metrics_path defaults to '/metrics'
-    # scheme defaults to 'http'.
-
+    metrics_path: '/prometheus/metrics'
     static_configs:
       - targets: ['localhost:9090']
 
-  - job_name: node
-    # If prometheus-node-exporter is installed, grab stats about the local
-    # machine by default.
+  - job_name: 'mysql'
     static_configs:
-      - targets: ['localhost:9100']
+      - targets:
+                - davidayson8-1:9104
+                - davidayson8-2:9104
+        
+  - job_name: 'bind9'
+    static_configs:
+      - targets:
+                - ns-3:9119
+                - ns-1:9119
+                - ns-2:9119
+        
+  - job_name: 'nginx'
+    static_configs:
+      - targets:
+                - www-1:9113
+                - www-2:9113
+                - www-3:9113
+        
+  - job_name: 'influxdb'
+    static_configs:
+      - targets:
+              - influxdb:9424
+      
+  - job_name: 'backup'
+    static_configs:
+      - targets:
+        - 192.168.42.132:9111
+  
+  - job_name: 'keepalived'
+    static_configs:
+      - targets:
+                  - davidayson8-1:9165
+                  - davidayson8-2:9165
+        
+  - job_name: 'haproxy'
+    static_configs:
+      - targets:
+                  - lb-1:9101
+                  - lb-2:9101
+        

changed: [davidayson8-3]
 __________________________________________________________
< TASK [prometheus : Run Prometheus Web External Template] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/default/prometheus
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp1usnsqi3/metric.yaml.j2
@@ -1,110 +1 @@
-# Set the command-line arguments to pass to the server.
-# Due to shell escaping, to pass backslashes for regexes, you need to double
-# them (\\d for \d). If running under systemd, you need to double them again
-# (\\\\d to mean \d), and escape newlines too.
-ARGS=""
-
-# prometheus supports the following options:
-#
-#  --alertmanager.notification-queue-capacity=10000
-#    The capacity of the queue for pending Alertmanager notifications.
-#  --config.file="/etc/prometheus/prometheus.yml"
-#    Prometheus configuration file path.
-#  --enable-feature=<feature,...>
-#    Comma separated feature names to enable. Valid options:
-#    exemplar-storage, expand-external-labels, memory-snapshot-on-shutdown,
-#    promql-at-modifier, promql-negative-offset, remote-write-receiver,
-#    extra-scrape-metrics, new-service-discovery-manager. See
-#    https://prometheus.io/docs/prometheus/latest/feature_flags/ for more
-#    details.
-#  --log.format=logfmt
-#    Output format of log messages. One of: [logfmt, json].
-#  --log.level=info
-#    Only log messages with the given severity or above. One of: [debug, info,
-#    warn, error].
-#  --query.lookback-delta=5m
-#    The maximum lookback duration for retrieving metrics during expression
-#    evaluations and federation.
-#  --query.max-concurrency=20
-#    Maximum number of queries executed concurrently.
-#  --query.max-samples=50000000
-#    Maximum number of samples a single query can load into memory. Note that
-#    queries will fail if they try to load more samples than this into memory,
-#    so this also limits the number of samples a query can return.
-#  --query.timeout=2m
-#    Maximum time a query may take before being aborted.
-#  --rules.alert.for-grace-period=10m
-#    Minimum duration between alert and restored "for" state. This is
-#    maintained only for alerts with configured "for" time greater than grace
-#    period.
-#  --rules.alert.for-outage-tolerance=1h
-#    Max time to tolerate prometheus outage for restoring "for" state of alert.
-#  --rules.alert.resend-delay=1m
-#    Minimum amount of time to wait before resending an alert to Alertmanager.
-#  --storage.remote.flush-deadline=<duration>
-#    How long to wait flushing sample on shutdown or config reload.
-#  --storage.remote.read-concurrent-limit=10
-#    Maximum number of concurrent remote read calls. 0 means no limit.
-#  --storage.remote.read-max-bytes-in-frame=1048576
-#    Maximum number of bytes in a single frame for streaming remote read
-#    response types before marshalling. Note that client might have limit on
-#    frame size as well. 1MB as recommended by protobuf by default.
-#  --storage.remote.read-sample-limit=5e7
-#    Maximum overall number of samples to return via the remote read interface,
-#    in a single query. 0 means no limit. This limit is ignored for streamed
-#    response types.
-#  --storage.tsdb.allow-overlapping-blocks
-#    Allow overlapping blocks, which in turn enables vertical compaction and
-#    vertical query merge.
-#  --storage.tsdb.path="/var/lib/prometheus/metrics2/"
-#    Base path for metrics storage.
-#  --storage.tsdb.retention.size=STORAGE.TSDB.RETENTION.SIZE
-#    Maximum number of bytes that can be stored for blocks. A unit is required,
-#    supported units: B, KB, MB, GB, TB, PB, EB. Ex: "512MB".
-#  --storage.tsdb.retention.time=STORAGE.TSDB.RETENTION.TIME
-#    How long to retain samples in storage. When this flag is set it overrides
-#    "storage.tsdb.retention". If neither this flag nor
-#    "storage.tsdb.retention" nor "storage.tsdb.retention.size" is set, the
-#    retention time defaults to 15d. Units Supported: y, w, d, h, m, s, ms.
-#  --storage.tsdb.retention=STORAGE.TSDB.RETENTION
-#    [DEPRECATED] How long to retain samples in storage. This flag has been
-#    deprecated, use "storage.tsdb.retention.time" instead.
-#  --storage.tsdb.use-lockfile
-#    Create a lockfile in data directory.
-#  --web.config.file=""
-#    [EXPERIMENTAL] Path to configuration file that can enable TLS or
-#    authentication.
-#  --web.console.libraries="/etc/prometheus/console_libraries"
-#    Path to the console library directory.
-#  --web.console.templates="/etc/prometheus/consoles"
-#    Path to the console template directory, available at /consoles.
-#  --web.cors.origin=".*"
-#    Regex for CORS origin. It is fully anchored. Example:
-#    'https?://(domain1|domain2)\.com'.
-#  --web.enable-admin-api
-#    Enable API endpoints for admin control actions.
-#  --web.enable-lifecycle
-#    Enable shutdown and reload via HTTP request.
-#  --web.external-url=<URL>
-#    The URL under which Prometheus is externally reachable (for example, if
-#    Prometheus is served via a reverse proxy). Used for generating relative
-#    and absolute links back to Prometheus itself. If the URL has a path
-#    portion, it will be used to prefix all HTTP endpoints served by
-#    Prometheus. If omitted, relevant URL components will be derived
-#    automatically.
-#  --web.listen-address="0.0.0.0:9090"
-#    Address to listen on for UI, API, and telemetry.
-#  --web.local-assets="/usr/share/prometheus/web/"
-#    Path to static asset/templates directory.
-#  --web.max-connections=512
-#    Maximum number of simultaneous connections.
-#  --web.page-title="Prometheus Time Series Collection and Processing Server"
-#    Document title of Prometheus instance.
-#  --web.read-timeout=5m
-#    Maximum duration before timing out read of the request, and closing idle
-#    connections.
-#  --web.route-prefix=<path>
-#    Prefix for the internal routes of web endpoints. Defaults to path of
-#    --web.external-url.
-#  --web.user-assets=<path>
-#    Path to user asset directory, available at /user.
+ARGS='--web.external-url=http://prometheus/prometheus'

changed: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 ___________________________________________________
< RUNNING HANDLER [prometheus : Restart Prometheus] >
 ---------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 _________________________
< PLAY [Keepalived setup] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________________
< TASK [keepalived : Make Keepalived Directory] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/etc/keepalived/",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-1]
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/etc/keepalived/",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-2]
 ________________________________________
< TASK [keepalived : Install Keepalived] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  ipvsadm libsensors-config libsensors5 libsnmp-base libsnmp40
Suggested packages:
  heartbeat ldirectord lm-sensors snmp-mibs-downloader
The following NEW packages will be installed:
  ipvsadm keepalived libsensors-config libsensors5 libsnmp-base libsnmp40
0 upgraded, 6 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
The following additional packages will be installed:
  ipvsadm libsensors-config libsensors5 libsnmp-base libsnmp40
Suggested packages:
  heartbeat ldirectord lm-sensors snmp-mibs-downloader
The following NEW packages will be installed:
  ipvsadm keepalived libsensors-config libsensors5 libsnmp-base libsnmp40
0 upgraded, 6 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
 ______________________________________________
< TASK [keepalived : Create keepalived_script] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 _______________________________________
< TASK [keepalived : Keepalived script] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpvn7divoq/keepalived_script.sh
@@ -0,0 +1,2 @@
+#!/bin/bash
+ss -ntl | grep -q ':88 '

changed: [davidayson8-1]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpnrw24a44/keepalived_script.sh
@@ -0,0 +1,2 @@
+#!/bin/bash
+ss -ntl | grep -q ':88 '

changed: [davidayson8-2]
 _______________________________________
< TASK [keepalived : Keepalived Config] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 _____________________________________________________
/ TASK [keepalived : Ensure Keepalived is enabled and \
\ started]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 __________________________________________________________
< TASK [keepalived : Download Keepalived exporter package] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 ___________________________________________________________
< TASK [keepalived : Unarchive Keepalived exporter package] >
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 _________________________________________________
< TASK [keepalived : Keepalived Exporter Service] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp23we16e7/keepalived-exporter.service
@@ -0,0 +1,11 @@
+[Unit]
+Description=Keepalived Exporter
+Documentation=https://github.com/mehdy/keepalived-exporter
+After=network-online.target
+
+[Service]
+User=root
+ExecStart=/usr/local/bin/keepalived-exporter
+
+[Install]
+WantedBy=multi-user.target

changed: [davidayson8-1]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp25s5xvt2/keepalived-exporter.service
@@ -0,0 +1,11 @@
+[Unit]
+Description=Keepalived Exporter
+Documentation=https://github.com/mehdy/keepalived-exporter
+After=network-online.target
+
+[Service]
+User=root
+ExecStart=/usr/local/bin/keepalived-exporter
+
+[Install]
+WantedBy=multi-user.target

changed: [davidayson8-2]
 _____________________________________________________
/ TASK [keepalived : Ensure Keepalived is enabled and \
\ started]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 ____________________________________________________________
< RUNNING HANDLER [keepalived : Restart keepalived-exporter] >
 ------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 ______________________
< PLAY [Haproxy Setup] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________
< TASK [haproxy : Install Haproxy] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  liblua5.3-0
Suggested packages:
  vim-haproxy haproxy-doc
The following NEW packages will be installed:
  haproxy liblua5.3-0
0 upgraded, 2 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
The following additional packages will be installed:
  liblua5.3-0
Suggested packages:
  vim-haproxy haproxy-doc
The following NEW packages will be installed:
  haproxy liblua5.3-0
0 upgraded, 2 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
 _________________________________
< TASK [haproxy : Haproxy Config] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/haproxy/haproxy.cfg
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpulnmb3cz/haproxy.cnf.j2
@@ -1,34 +1,53 @@
 global
-	log /dev/log	local0
-	log /dev/log	local1 notice
-	chroot /var/lib/haproxy
-	stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
-	stats timeout 30s
-	user haproxy
-	group haproxy
-	daemon
+        log /dev/log    local0
+        log /dev/log    local1 notice
+        chroot /var/lib/haproxy
+        stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
+        stats timeout 30s
+        user haproxy
+        group haproxy
+        daemon
 
-	# Default SSL material locations
-	ca-base /etc/ssl/certs
-	crt-base /etc/ssl/private
+        # Default SSL material locations
+        ca-base /etc/ssl/certs
+        crt-base /etc/ssl/private
 
-	# See: https://ssl-config.mozilla.org/#server=haproxy&server-version=2.0.3&config=intermediate
-        ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384
-        ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
+        # See: https://ssl-config.mozilla.org/#server=haproxy&server-version=2.0.3&co>
+        ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-S>
+        ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:T>
         ssl-default-bind-options ssl-min-ver TLSv1.2 no-tls-tickets
 
 defaults
-	log	global
-	mode	http
-	option	httplog
-	option	dontlognull
+        log     global
+        mode    http
+        option  httplog 
+        option  dontlognull
         timeout connect 5000
         timeout client  50000
         timeout server  50000
-	errorfile 400 /etc/haproxy/errors/400.http
-	errorfile 403 /etc/haproxy/errors/403.http
-	errorfile 408 /etc/haproxy/errors/408.http
-	errorfile 500 /etc/haproxy/errors/500.http
-	errorfile 502 /etc/haproxy/errors/502.http
-	errorfile 503 /etc/haproxy/errors/503.http
-	errorfile 504 /etc/haproxy/errors/504.http
+        errorfile 400 /etc/haproxy/errors/400.http
+        errorfile 403 /etc/haproxy/errors/403.http
+        errorfile 408 /etc/haproxy/errors/408.http
+        errorfile 500 /etc/haproxy/errors/500.http
+        errorfile 502 /etc/haproxy/errors/502.http
+        errorfile 503 /etc/haproxy/errors/503.http
+        errorfile 504 /etc/haproxy/errors/504.http
+
+listen my_ha_frontend
+    bind :88
+    default_backend my_ha_backend
+
+backend my_ha_backend
+    server docker-1-8001 lb-1:8001 check
+    server docker-1-8002 lb-1:8002 check
+    server docker-1-8003 lb-1:8003 check
+    server docker-2-8001 lb-2:8001 check
+    server docker-2-8002 lb-2:8002 check
+    server docker-2-8003 lb-2:8003 check
+
+listen stats
+    bind :9188
+    stats enable
+    stats uri /stats
+    stats refresh 5s
+

changed: [davidayson8-1]
--- before: /etc/haproxy/haproxy.cfg
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpmx4y3lbq/haproxy.cnf.j2
@@ -1,34 +1,53 @@
 global
-	log /dev/log	local0
-	log /dev/log	local1 notice
-	chroot /var/lib/haproxy
-	stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
-	stats timeout 30s
-	user haproxy
-	group haproxy
-	daemon
+        log /dev/log    local0
+        log /dev/log    local1 notice
+        chroot /var/lib/haproxy
+        stats socket /run/haproxy/admin.sock mode 660 level admin expose-fd listeners
+        stats timeout 30s
+        user haproxy
+        group haproxy
+        daemon
 
-	# Default SSL material locations
-	ca-base /etc/ssl/certs
-	crt-base /etc/ssl/private
+        # Default SSL material locations
+        ca-base /etc/ssl/certs
+        crt-base /etc/ssl/private
 
-	# See: https://ssl-config.mozilla.org/#server=haproxy&server-version=2.0.3&config=intermediate
-        ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384
-        ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256
+        # See: https://ssl-config.mozilla.org/#server=haproxy&server-version=2.0.3&co>
+        ssl-default-bind-ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-S>
+        ssl-default-bind-ciphersuites TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384:T>
         ssl-default-bind-options ssl-min-ver TLSv1.2 no-tls-tickets
 
 defaults
-	log	global
-	mode	http
-	option	httplog
-	option	dontlognull
+        log     global
+        mode    http
+        option  httplog 
+        option  dontlognull
         timeout connect 5000
         timeout client  50000
         timeout server  50000
-	errorfile 400 /etc/haproxy/errors/400.http
-	errorfile 403 /etc/haproxy/errors/403.http
-	errorfile 408 /etc/haproxy/errors/408.http
-	errorfile 500 /etc/haproxy/errors/500.http
-	errorfile 502 /etc/haproxy/errors/502.http
-	errorfile 503 /etc/haproxy/errors/503.http
-	errorfile 504 /etc/haproxy/errors/504.http
+        errorfile 400 /etc/haproxy/errors/400.http
+        errorfile 403 /etc/haproxy/errors/403.http
+        errorfile 408 /etc/haproxy/errors/408.http
+        errorfile 500 /etc/haproxy/errors/500.http
+        errorfile 502 /etc/haproxy/errors/502.http
+        errorfile 503 /etc/haproxy/errors/503.http
+        errorfile 504 /etc/haproxy/errors/504.http
+
+listen my_ha_frontend
+    bind :88
+    default_backend my_ha_backend
+
+backend my_ha_backend
+    server docker-1-8001 lb-1:8001 check
+    server docker-1-8002 lb-1:8002 check
+    server docker-1-8003 lb-1:8003 check
+    server docker-2-8001 lb-2:8001 check
+    server docker-2-8002 lb-2:8002 check
+    server docker-2-8003 lb-2:8003 check
+
+listen stats
+    bind :9188
+    stats enable
+    stats uri /stats
+    stats refresh 5s
+

changed: [davidayson8-2]
 ___________________________________________
< TASK [haproxy : Install Haproxy Exporter] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following NEW packages will be installed:
  prometheus-haproxy-exporter
0 upgraded, 1 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
The following NEW packages will be installed:
  prometheus-haproxy-exporter
0 upgraded, 1 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
 __________________________________________
< TASK [haproxy : Haproxy Exporter config] >
 ------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/default/prometheus-haproxy-exporter
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpek_sxhha/haproxy_exporter.j2
@@ -1,35 +1 @@
-# Set the command-line arguments to pass to the server.
-# Due to shell scaping, to pass backslashes for regexes, you need to double
-# them (\\d for \d). If running under systemd, you need to double them again
-# (\\\\d to mean \d), and escape newlines too.
-ARGS=""
-
-# Prometheus-haproxy-exporter supports the following options:
-#
-#  --web.listen-address=":9101"
-#    Address to listen on for web interface and telemetry.
-#  --web.telemetry-path="/metrics"
-#    Path under which to expose metrics.
-#  --haproxy.scrape-uri="http://localhost/;csv"
-#    URI on which to scrape HAProxy.
-#  --haproxy.ssl-verify
-#    Flag that enables SSL certificate verification for the scrape URI
-#  --haproxy.server-metric-fields="2,3,4,5,6,7,8,9,13,14,15,16,17,18,21,24,33,35,38,39,40,41,42,43,44"
-#    Comma-separated list of exported server metrics. See
-#    http://cbonte.github.io/haproxy-dconv/configuration-1.5.html#9.1
-#  --haproxy.timeout=5s
-#    Timeout for trying to get stats from HAProxy.
-#  --haproxy.pid-file=""
-#    Path to HAProxy pid file.
-#
-#    If provided, the standard process metrics get exported for the HAProxy
-#    process, prefixed with 'haproxy_process_...'. The haproxy_process exporter
-#    needs to have read access to files owned by the HAProxy process. Depends
-#    on the availability of /proc.
-#    https://prometheus.io/docs/instrumenting/writing_clientlibs/#process-metrics.
-#  --log.level="info"
-#    Only log messages with the given severity or above.
-#    Valid levels: [debug, info, warn, error, fatal]
-#  --log.format="logger:stderr"
-#    Set the log target and format. Example:
-#    "logger:syslog?appname=bob&local=7" or "logger:stdout?json=true"
+ARGS="--haproxy.scrape-uri='http://localhost:9188/stats;csv'"

changed: [davidayson8-1]
--- before: /etc/default/prometheus-haproxy-exporter
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp2nlg38ou/haproxy_exporter.j2
@@ -1,35 +1 @@
-# Set the command-line arguments to pass to the server.
-# Due to shell scaping, to pass backslashes for regexes, you need to double
-# them (\\d for \d). If running under systemd, you need to double them again
-# (\\\\d to mean \d), and escape newlines too.
-ARGS=""
-
-# Prometheus-haproxy-exporter supports the following options:
-#
-#  --web.listen-address=":9101"
-#    Address to listen on for web interface and telemetry.
-#  --web.telemetry-path="/metrics"
-#    Path under which to expose metrics.
-#  --haproxy.scrape-uri="http://localhost/;csv"
-#    URI on which to scrape HAProxy.
-#  --haproxy.ssl-verify
-#    Flag that enables SSL certificate verification for the scrape URI
-#  --haproxy.server-metric-fields="2,3,4,5,6,7,8,9,13,14,15,16,17,18,21,24,33,35,38,39,40,41,42,43,44"
-#    Comma-separated list of exported server metrics. See
-#    http://cbonte.github.io/haproxy-dconv/configuration-1.5.html#9.1
-#  --haproxy.timeout=5s
-#    Timeout for trying to get stats from HAProxy.
-#  --haproxy.pid-file=""
-#    Path to HAProxy pid file.
-#
-#    If provided, the standard process metrics get exported for the HAProxy
-#    process, prefixed with 'haproxy_process_...'. The haproxy_process exporter
-#    needs to have read access to files owned by the HAProxy process. Depends
-#    on the availability of /proc.
-#    https://prometheus.io/docs/instrumenting/writing_clientlibs/#process-metrics.
-#  --log.level="info"
-#    Only log messages with the given severity or above.
-#    Valid levels: [debug, info, warn, error, fatal]
-#  --log.format="logger:stderr"
-#    Set the log target and format. Example:
-#    "logger:syslog?appname=bob&local=7" or "logger:stdout?json=true"
+ARGS="--haproxy.scrape-uri='http://localhost:9188/stats;csv'"

changed: [davidayson8-2]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 _____________________________________________
< RUNNING HANDLER [haproxy : Restart Haproxy] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 ______________________________________________________
< RUNNING HANDLER [haproxy : Restart Haproxy Exporter] >
 ------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 _____________________
< PLAY [Docker Setup] >
 ---------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
ok: [davidayson8-3]
 ______________________________________________
< TASK [docker : Install docker and Resources] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  bridge-utils containerd dnsmasq-base pigz python3-websocket runc ubuntu-fan
Suggested packages:
  ifupdown aufs-tools cgroupfs-mount | cgroup-lite debootstrap docker-doc
  rinse zfs-fuse | zfsutils
The following NEW packages will be installed:
  bridge-utils containerd dnsmasq-base docker.io pigz python3-docker
  python3-websocket runc ubuntu-fan
0 upgraded, 9 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
The following additional packages will be installed:
  bridge-utils containerd dnsmasq-base pigz python3-websocket runc ubuntu-fan
Suggested packages:
  ifupdown aufs-tools cgroupfs-mount | cgroup-lite debootstrap docker-doc
  rinse zfs-fuse | zfsutils
The following NEW packages will be installed:
  bridge-utils containerd dnsmasq-base docker.io pigz python3-docker
  python3-websocket runc ubuntu-fan
0 upgraded, 9 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
The following additional packages will be installed:
  bridge-utils containerd dnsmasq-base pigz python3-websocket runc ubuntu-fan
Suggested packages:
  ifupdown aufs-tools cgroupfs-mount | cgroup-lite debootstrap docker-doc
  rinse zfs-fuse | zfsutils
The following NEW packages will be installed:
  bridge-utils containerd dnsmasq-base docker.io pigz python3-docker
  python3-websocket runc ubuntu-fan
0 upgraded, 9 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-3]
 ________________________
< PLAY [Install Grafana] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________
< TASK [grafana : Create Grafana directories] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/grafana/provisioning/dashboards",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-3] => (item=dashboards)
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/grafana/provisioning/datasources",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-3] => (item=datasources)
 _________________________________
< TASK [grafana : Copy main.json] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/ica0002/ica0002/roles/grafana/files/main.json
@@ -0,0 +1,1365 @@
+{
+  "annotations": {
+    "list": [
+      {
+        "builtIn": 1,
+        "datasource": {
+          "type": "grafana",
+          "uid": "-- Grafana --"
+        },
+        "enable": true,
+        "hide": true,
+        "iconColor": "rgba(0, 211, 255, 1)",
+        "name": "Annotations & Alerts",
+        "type": "dashboard"
+      }
+    ]
+  },
+  "editable": true,
+  "fiscalYearStartMonth": 0,
+  "graphTooltip": 0,
+  "id": 2,
+  "links": [],
+  "panels": [
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 12,
+        "x": 0,
+        "y": 0
+      },
+      "id": 12,
+      "options": {
+        "minVizHeight": 75,
+        "minVizWidth": 75,
+        "orientation": "auto",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showThresholdLabels": false,
+        "showThresholdMarkers": true,
+        "sizing": "auto"
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "((node_memory_Buffers_bytes + node_memory_Cached_bytes + node_memory_MemFree_bytes) / node_memory_MemTotal_bytes ) * 100",
+          "instant": false,
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "Memory Usage",
+      "type": "gauge"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 12,
+        "x": 12,
+        "y": 0
+      },
+      "id": 2,
+      "options": {
+        "minVizHeight": 75,
+        "minVizWidth": 75,
+        "orientation": "auto",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showThresholdLabels": false,
+        "showThresholdMarkers": true,
+        "sizing": "auto"
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "(1 - rate(node_cpu_seconds_total{mode=\"idle\"}[1m])) * 100",
+          "instant": false,
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "CPU Usage",
+      "type": "gauge"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "0": {
+                  "color": "dark-red",
+                  "index": 1,
+                  "text": "Down"
+                },
+                "1": {
+                  "color": "green",
+                  "index": 0,
+                  "text": "UP"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 3,
+        "x": 0,
+        "y": 6
+      },
+      "id": 10,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "influxdb_exporter_stats_query_success",
+          "hide": false,
+          "instant": false,
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "InlfluxDB Stat Exporter",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "",
+            "axisPlacement": "auto",
+            "fillOpacity": 100,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "lineWidth": 1,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": [
+          {
+            "__systemRef": "hideSeriesFrom",
+            "matcher": {
+              "id": "byNames",
+              "options": {
+                "mode": "exclude",
+                "names": [
+                  "{instance=\"davidayson8-1:5000\", job=\"influxdb exporter\"}"
+                ],
+                "prefix": "All except:",
+                "readOnly": true
+              }
+            },
+            "properties": [
+              {
+                "id": "custom.hideFrom",
+                "value": {
+                  "legend": false,
+                  "tooltip": false,
+                  "viz": true
+                }
+              }
+            ]
+          }
+        ]
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 9,
+        "x": 3,
+        "y": 6
+      },
+      "id": 11,
+      "options": {
+        "barRadius": 0,
+        "barWidth": 1,
+        "fullHighlight": false,
+        "groupWidth": 0.7,
+        "legend": {
+          "calcs": [],
+          "displayMode": "list",
+          "placement": "bottom",
+          "showLegend": true
+        },
+        "orientation": "auto",
+        "showValue": "auto",
+        "stacking": "none",
+        "tooltip": {
+          "mode": "single",
+          "sort": "none"
+        },
+        "xTickLabelRotation": 0,
+        "xTickLabelSpacing": 100
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "rate(influxdb_write_write_ok[1m])",
+          "instant": false,
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "InfluxDB Write Rate",
+      "type": "barchart"
+    },
+    {
+      "datasource": {
+        "type": "influxdb",
+        "uid": "1e2f45c9-a123-4690-bca5-34dc1adcb254"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 11,
+        "w": 12,
+        "x": 12,
+        "y": 6
+      },
+      "id": 14,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "influxdb",
+            "uid": "1e2f45c9-a123-4690-bca5-34dc1adcb254"
+          },
+          "query": "SELECT sum(\"items\") FROM \"autogen\".\"agama-stats\" WHERE $timeFilter GROUP BY time(1m) fill(null)\n",
+          "rawQuery": true,
+          "refId": "A",
+          "resultFormat": "time_series"
+        }
+      ],
+      "title": "Item Counts for All Discovered Agamas",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "0": {
+                  "color": "dark-red",
+                  "index": 1,
+                  "text": "Down"
+                },
+                "1": {
+                  "color": "green",
+                  "index": 0,
+                  "text": "UP"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 3,
+        "x": 0,
+        "y": 12
+      },
+      "id": 6,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "disableTextWrap": false,
+          "editorMode": "builder",
+          "expr": "bind_up",
+          "fullMetaSearch": false,
+          "includeNullMetadata": true,
+          "instant": false,
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A",
+          "useBackend": false
+        }
+      ],
+      "title": "Bind9 Status",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "",
+            "axisPlacement": "auto",
+            "fillOpacity": 80,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "lineWidth": 1,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 9,
+        "x": 3,
+        "y": 12
+      },
+      "id": 4,
+      "options": {
+        "barRadius": 0,
+        "barWidth": 0.97,
+        "fullHighlight": false,
+        "groupWidth": 0.7,
+        "legend": {
+          "calcs": [],
+          "displayMode": "list",
+          "placement": "bottom",
+          "showLegend": true
+        },
+        "orientation": "auto",
+        "showValue": "auto",
+        "stacking": "none",
+        "tooltip": {
+          "mode": "single",
+          "sort": "none"
+        },
+        "xTickLabelRotation": 0,
+        "xTickLabelSpacing": 100
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "rate(bind_resolver_queries_total{type=\"A\"}[1m])",
+          "instant": false,
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        },
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "expr": "",
+          "hide": false,
+          "instant": false,
+          "range": true,
+          "refId": "B"
+        }
+      ],
+      "title": "Bind9 Request Per Min",
+      "type": "barchart"
+    },
+    {
+      "datasource": {
+        "type": "influxdb",
+        "uid": "1e2f45c9-a123-4690-bca5-34dc1adcb254"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 13,
+        "w": 12,
+        "x": 12,
+        "y": 17
+      },
+      "id": 13,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "influxdb",
+            "uid": "1e2f45c9-a123-4690-bca5-34dc1adcb254"
+          },
+          "query": "SELECT distinct(\"items\") FROM \"agama-stats\" WHERE $timeFilter GROUP BY \"name::'davidayson8-1.agamadb'\"",
+          "rawQuery": true,
+          "refId": "A",
+          "resultFormat": "time_series"
+        }
+      ],
+      "title": "Agama Items",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "0": {
+                  "color": "dark-red",
+                  "index": 1,
+                  "text": "Down"
+                },
+                "1": {
+                  "color": "green",
+                  "index": 0,
+                  "text": "UP"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 3,
+        "x": 0,
+        "y": 18
+      },
+      "id": 7,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "mysql_up",
+          "instant": false,
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Status",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "",
+            "axisPlacement": "auto",
+            "fillOpacity": 80,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "lineWidth": 1,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 9,
+        "x": 3,
+        "y": 18
+      },
+      "id": 3,
+      "options": {
+        "barRadius": 0,
+        "barWidth": 0.97,
+        "fullHighlight": false,
+        "groupWidth": 0.7,
+        "legend": {
+          "calcs": [],
+          "displayMode": "list",
+          "placement": "bottom",
+          "showLegend": true
+        },
+        "orientation": "auto",
+        "showValue": "auto",
+        "stacking": "none",
+        "tooltip": {
+          "mode": "single",
+          "sort": "none"
+        },
+        "xTickLabelRotation": 0,
+        "xTickLabelSpacing": 100
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "rate(mysql_global_status_commands_total{command=\"select\"}[1m])",
+          "instant": false,
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Request Per Min",
+      "type": "barchart"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "0": {
+                  "index": 1,
+                  "text": "DOWN"
+                },
+                "1": {
+                  "index": 0,
+                  "text": "UP"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 3,
+        "x": 0,
+        "y": 24
+      },
+      "id": 8,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "nginx_up",
+          "instant": false,
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "Nginx Status",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "",
+            "axisPlacement": "auto",
+            "fillOpacity": 80,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "lineWidth": 1,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 6,
+        "w": 9,
+        "x": 3,
+        "y": 24
+      },
+      "id": 5,
+      "options": {
+        "barRadius": 0,
+        "barWidth": 0.97,
+        "fullHighlight": false,
+        "groupWidth": 0.7,
+        "legend": {
+          "calcs": [],
+          "displayMode": "list",
+          "placement": "bottom",
+          "showLegend": true
+        },
+        "orientation": "auto",
+        "showValue": "auto",
+        "stacking": "none",
+        "tooltip": {
+          "mode": "single",
+          "sort": "none"
+        },
+        "xTickLabelRotation": 0,
+        "xTickLabelSpacing": 100
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "rate(nginx_http_requests_total[1m])",
+          "instant": false,
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "Nginx Request Per Min",
+      "type": "barchart"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "1": {
+                  "index": 0,
+                  "text": "Up"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 0,
+        "y": 30
+      },
+      "id": 15,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "keepalived_up",
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "Keepalived Status",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "1": {
+                  "index": 1,
+                  "text": "Backup"
+                },
+                "2": {
+                  "index": 0,
+                  "text": "Master"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 12,
+        "y": 30
+      },
+      "id": 16,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "keepalived_vrrp_state",
+          "legendFormat": "{{ instance }}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "Keepalived VRRP State",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "1": {
+                  "index": 0,
+                  "text": "Up"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 0,
+        "y": 38
+      },
+      "id": 17,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "haproxy_up",
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "Haproxy Status",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [
+            {
+              "options": {
+                "1": {
+                  "index": 0,
+                  "text": "Up"
+                }
+              },
+              "type": "value"
+            }
+          ],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 12,
+        "y": 38
+      },
+      "id": 18,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "haproxy_server_up",
+          "legendFormat": "{{instance}}",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "Haproxy Containers",
+      "type": "stat"
+    }
+  ],
+  "preload": false,
+  "refresh": "",
+  "schemaVersion": 40,
+  "tags": [],
+  "templating": {
+    "list": []
+  },
+  "time": {
+    "from": "now-6h",
+    "to": "now"
+  },
+  "timepicker": {},
+  "timezone": "",
+  "title": "Main",
+  "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51",
+  "version": 4,
+  "weekStart": ""
+}

changed: [davidayson8-3]
 ____________________________________
< TASK [grafana : Copy backups.json] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/ica0002/ica0002/roles/grafana/files/backups.json
@@ -0,0 +1,307 @@
+{
+  "annotations": {
+    "list": [
+      {
+        "builtIn": 1,
+        "datasource": {
+          "type": "grafana",
+          "uid": "-- Grafana --"
+        },
+        "enable": true,
+        "hide": true,
+        "iconColor": "rgba(0, 211, 255, 1)",
+        "name": "Annotations & Alerts",
+        "type": "dashboard"
+      }
+    ]
+  },
+  "editable": true,
+  "fiscalYearStartMonth": 0,
+  "graphTooltip": 0,
+  "id": 1,
+  "links": [],
+  "panels": [
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 0,
+        "y": 0
+      },
+      "id": 1,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "exemplar": false,
+          "expr": "backups_total{user=\"davidayson8\", service=\"mysql\", type=\"full\"}\r\n",
+          "format": "time_series",
+          "instant": false,
+          "interval": "",
+          "legendFormat": "{{instance}} - {{service}} - {{type}} - {{user}}",
+          "range": true,
+          "refId": "Full Backups"
+        }
+      ],
+      "title": "MySQL Full Backups",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 12,
+        "y": 0
+      },
+      "id": 2,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "backups_total{user=\"davidayson8\", service=\"influxdb\", type=\"full\"}\r\n",
+          "legendFormat": "{{instance}} - {{service}} - {{type}} - {{user}}",
+          "range": true,
+          "refId": "Full Backups"
+        }
+      ],
+      "title": "InfluxDB Full Backups",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          },
+          "unit": "s"
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 0,
+        "y": 8
+      },
+      "id": 3,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "time() - backup_last_success_time{user=\"davidayson8\",service=\"mysql\"}",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Backup Time",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          },
+          "unit": "s"
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 12,
+        "y": 8
+      },
+      "id": 4,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "time() - backup_last_success_time{user=\"davidayson8\",service=\"influxdb\"}\r\n",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "InfluxDB Backup Time",
+      "type": "stat"
+    }
+  ],
+  "preload": false,
+  "schemaVersion": 40,
+  "tags": [],
+  "templating": {
+    "list": []
+  },
+  "time": {
+    "from": "now-6h",
+    "to": "now"
+  },
+  "timepicker": {},
+  "timezone": "browser",
+  "title": "Backups",
+  "uid": "fe6l4plsczhmoa",
+  "version": 4,
+  "weekStart": ""
+}

changed: [davidayson8-3]
 ___________________________________
< TASK [grafana : Copy syslog.json] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/ica0002/ica0002/roles/grafana/files/syslog.json
@@ -0,0 +1,1118 @@
+{
+  "annotations": {
+    "list": [
+      {
+        "builtIn": 1,
+        "datasource": {
+          "type": "datasource",
+          "uid": "grafana"
+        },
+        "enable": true,
+        "hide": true,
+        "iconColor": "rgba(0, 211, 255, 1)",
+        "name": "Annotations & Alerts",
+        "type": "dashboard"
+      }
+    ]
+  },
+  "description": "Telegraf / InfluxDB / Grafana as syslog receiver",
+  "editable": true,
+  "fiscalYearStartMonth": 0,
+  "graphTooltip": 0,
+  "id": 5,
+  "links": [],
+  "panels": [
+    {
+      "datasource": {
+        "type": "influxdb",
+        "uid": "TIYeHqRgZ"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "Messages / min",
+            "axisPlacement": "auto",
+            "barAlignment": 0,
+            "barWidthFactor": 0.6,
+            "drawStyle": "bars",
+            "fillOpacity": 100,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "insertNulls": false,
+            "lineInterpolation": "linear",
+            "lineWidth": 1,
+            "pointSize": 5,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "showPoints": "never",
+            "spanNulls": true,
+            "stacking": {
+              "group": "A",
+              "mode": "none"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "decimals": 0,
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          },
+          "unit": "none"
+        },
+        "overrides": [
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Info"
+            },
+            "properties": [
+              {
+                "id": "color",
+                "value": {
+                  "fixedColor": "rgb(80, 80, 80)",
+                  "mode": "fixed"
+                }
+              },
+              {
+                "id": "custom.stacking",
+                "value": {
+                  "group": "A",
+                  "mode": "normal"
+                }
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Notice"
+            },
+            "properties": [
+              {
+                "id": "color",
+                "value": {
+                  "fixedColor": "rgb(182, 182, 182)",
+                  "mode": "fixed"
+                }
+              },
+              {
+                "id": "custom.stacking",
+                "value": {
+                  "group": "A",
+                  "mode": "normal"
+                }
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Warning"
+            },
+            "properties": [
+              {
+                "id": "color",
+                "value": {
+                  "fixedColor": "#E0B400",
+                  "mode": "fixed"
+                }
+              },
+              {
+                "id": "custom.stacking",
+                "value": {
+                  "group": "A",
+                  "mode": "normal"
+                }
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Error"
+            },
+            "properties": [
+              {
+                "id": "color",
+                "value": {
+                  "fixedColor": "#FF780A",
+                  "mode": "fixed"
+                }
+              },
+              {
+                "id": "custom.stacking",
+                "value": {
+                  "group": "A",
+                  "mode": "normal"
+                }
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Critical"
+            },
+            "properties": [
+              {
+                "id": "color",
+                "value": {
+                  "fixedColor": "#E02F44",
+                  "mode": "fixed"
+                }
+              },
+              {
+                "id": "custom.stacking",
+                "value": {
+                  "group": "A",
+                  "mode": "normal"
+                }
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Alert"
+            },
+            "properties": [
+              {
+                "id": "color",
+                "value": {
+                  "fixedColor": "#8F3BB8",
+                  "mode": "fixed"
+                }
+              },
+              {
+                "id": "custom.stacking",
+                "value": {
+                  "group": "A",
+                  "mode": "normal"
+                }
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Emergency"
+            },
+            "properties": [
+              {
+                "id": "color",
+                "value": {
+                  "fixedColor": "#8F3BB8",
+                  "mode": "fixed"
+                }
+              },
+              {
+                "id": "custom.stacking",
+                "value": {
+                  "group": "A",
+                  "mode": "normal"
+                }
+              }
+            ]
+          }
+        ]
+      },
+      "gridPos": {
+        "h": 7,
+        "w": 24,
+        "x": 0,
+        "y": 0
+      },
+      "id": 10,
+      "options": {
+        "alertThreshold": true,
+        "legend": {
+          "calcs": [
+            "mean",
+            "max",
+            "sum"
+          ],
+          "displayMode": "table",
+          "placement": "right",
+          "showLegend": true
+        },
+        "tooltip": {
+          "mode": "multi",
+          "sort": "none"
+        }
+      },
+      "pluginVersion": "11.3.2",
+      "targets": [
+        {
+          "alias": "Info",
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "1m"
+              ],
+              "type": "time"
+            },
+            {
+              "params": [
+                "null"
+              ],
+              "type": "fill"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "A",
+          "resultFormat": "time_series",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              },
+              {
+                "params": [],
+                "type": "count"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "severity",
+              "operator": "=",
+              "value": "info"
+            },
+            {
+              "condition": "AND",
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        },
+        {
+          "alias": "Notice",
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "1m"
+              ],
+              "type": "time"
+            },
+            {
+              "params": [
+                "null"
+              ],
+              "type": "fill"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "B",
+          "resultFormat": "time_series",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              },
+              {
+                "params": [],
+                "type": "count"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "severity",
+              "operator": "=",
+              "value": "notice"
+            },
+            {
+              "condition": "AND",
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        },
+        {
+          "alias": "Warning",
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "1m"
+              ],
+              "type": "time"
+            },
+            {
+              "params": [
+                "null"
+              ],
+              "type": "fill"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "D",
+          "resultFormat": "time_series",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              },
+              {
+                "params": [],
+                "type": "count"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "severity",
+              "operator": "=",
+              "value": "warning"
+            },
+            {
+              "condition": "AND",
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        },
+        {
+          "alias": "Error",
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "1m"
+              ],
+              "type": "time"
+            },
+            {
+              "params": [
+                "null"
+              ],
+              "type": "fill"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "C",
+          "resultFormat": "time_series",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              },
+              {
+                "params": [],
+                "type": "count"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "severity",
+              "operator": "=",
+              "value": "err"
+            },
+            {
+              "condition": "AND",
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        },
+        {
+          "alias": "Critical",
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "1m"
+              ],
+              "type": "time"
+            },
+            {
+              "params": [
+                "null"
+              ],
+              "type": "fill"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "E",
+          "resultFormat": "time_series",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              },
+              {
+                "params": [],
+                "type": "count"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "severity",
+              "operator": "=",
+              "value": "crit"
+            },
+            {
+              "condition": "AND",
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        },
+        {
+          "alias": "Alert",
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "1m"
+              ],
+              "type": "time"
+            },
+            {
+              "params": [
+                "null"
+              ],
+              "type": "fill"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "F",
+          "resultFormat": "time_series",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              },
+              {
+                "params": [],
+                "type": "count"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "severity",
+              "operator": "=",
+              "value": "alert"
+            },
+            {
+              "condition": "AND",
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        },
+        {
+          "alias": "Emergency",
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "1m"
+              ],
+              "type": "time"
+            },
+            {
+              "params": [
+                "null"
+              ],
+              "type": "fill"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "G",
+          "resultFormat": "time_series",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              },
+              {
+                "params": [],
+                "type": "count"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "severity",
+              "operator": "=",
+              "value": "emerg"
+            },
+            {
+              "condition": "AND",
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        }
+      ],
+      "title": "syslog count",
+      "type": "timeseries"
+    },
+    {
+      "datasource": {
+        "type": "influxdb",
+        "uid": "TIYeHqRgZ"
+      },
+      "description": "",
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "custom": {
+            "align": "left",
+            "cellOptions": {
+              "type": "auto"
+            },
+            "filterable": false,
+            "inspect": false
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "dark-purple",
+                "value": null
+              },
+              {
+                "color": "dark-red",
+                "value": 2
+              },
+              {
+                "color": "dark-orange",
+                "value": 3
+              },
+              {
+                "color": "dark-yellow",
+                "value": 4
+              },
+              {
+                "color": "rgb(150, 150, 150)",
+                "value": 5
+              },
+              {
+                "color": "rgb(51, 51, 51)",
+                "value": 6
+              },
+              {
+                "color": "rgb(5, 5, 5)",
+                "value": 7
+              }
+            ]
+          }
+        },
+        "overrides": [
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "severity_code"
+            },
+            "properties": [
+              {
+                "id": "mappings",
+                "value": [
+                  {
+                    "options": {
+                      "0": {
+                        "text": "Emergency"
+                      },
+                      "1": {
+                        "text": "Alert"
+                      },
+                      "2": {
+                        "text": "Critical"
+                      },
+                      "3": {
+                        "text": "Error"
+                      },
+                      "4": {
+                        "text": "Warning"
+                      },
+                      "5": {
+                        "text": "Notice"
+                      },
+                      "6": {
+                        "text": "Info"
+                      },
+                      "7": {
+                        "text": "Debug"
+                      }
+                    },
+                    "type": "value"
+                  }
+                ]
+              },
+              {
+                "id": "custom.cellOptions",
+                "value": {
+                  "mode": "gradient",
+                  "type": "color-background"
+                }
+              },
+              {
+                "id": "custom.width",
+                "value": 119
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "Time"
+            },
+            "properties": [
+              {
+                "id": "custom.width",
+                "value": 163
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "hostname"
+            },
+            "properties": [
+              {
+                "id": "custom.width",
+                "value": 194
+              }
+            ]
+          },
+          {
+            "matcher": {
+              "id": "byName",
+              "options": "appname"
+            },
+            "properties": [
+              {
+                "id": "custom.width",
+                "value": 264
+              }
+            ]
+          }
+        ]
+      },
+      "gridPos": {
+        "h": 24,
+        "w": 24,
+        "x": 0,
+        "y": 7
+      },
+      "id": 12,
+      "options": {
+        "cellHeight": "sm",
+        "footer": {
+          "countRows": false,
+          "fields": "",
+          "reducer": [
+            "sum"
+          ],
+          "show": false
+        },
+        "showHeader": true,
+        "sortBy": [
+          {
+            "desc": true,
+            "displayName": "Time"
+          }
+        ]
+      },
+      "pluginVersion": "11.3.2",
+      "targets": [
+        {
+          "datasource": {
+            "type": "influxdb",
+            "uid": "TIYeHqRgZ"
+          },
+          "groupBy": [
+            {
+              "params": [
+                "hostname"
+              ],
+              "type": "tag"
+            },
+            {
+              "params": [
+                "appname"
+              ],
+              "type": "tag"
+            }
+          ],
+          "measurement": "syslog",
+          "orderByTime": "ASC",
+          "policy": "default",
+          "refId": "A",
+          "resultFormat": "table",
+          "select": [
+            [
+              {
+                "params": [
+                  "severity_code"
+                ],
+                "type": "field"
+              }
+            ],
+            [
+              {
+                "params": [
+                  "message"
+                ],
+                "type": "field"
+              }
+            ]
+          ],
+          "tags": [
+            {
+              "key": "hostname",
+              "operator": "=~",
+              "value": "/^$hostname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "appname",
+              "operator": "=~",
+              "value": "/^$appname$/"
+            },
+            {
+              "condition": "AND",
+              "key": "severity",
+              "operator": "=~",
+              "value": "/^$severity$/"
+            },
+            {
+              "condition": "AND",
+              "key": "message",
+              "operator": "=~",
+              "value": "/$Query/"
+            }
+          ]
+        }
+      ],
+      "title": "Syslog Messages",
+      "type": "table"
+    }
+  ],
+  "preload": false,
+  "refresh": "5s",
+  "schemaVersion": 40,
+  "tags": [],
+  "templating": {
+    "list": [
+      {
+        "current": {
+          "text": "All",
+          "value": [
+            "$__all"
+          ]
+        },
+        "datasource": "TIYeHqRgZ",
+        "definition": "SHOW TAG VALUES FROM syslog WITH KEY=appname",
+        "includeAll": true,
+        "label": "Appname",
+        "multi": true,
+        "name": "appname",
+        "options": [],
+        "query": "SHOW TAG VALUES FROM syslog WITH KEY=appname",
+        "refresh": 2,
+        "regex": "",
+        "sort": 1,
+        "type": "query"
+      },
+      {
+        "current": {
+          "text": "All",
+          "value": [
+            "$__all"
+          ]
+        },
+        "datasource": "TIYeHqRgZ",
+        "definition": "SHOW TAG VALUES FROM syslog WITH KEY=hostname",
+        "includeAll": true,
+        "label": "Hostname",
+        "multi": true,
+        "name": "hostname",
+        "options": [],
+        "query": "SHOW TAG VALUES FROM syslog WITH KEY=hostname",
+        "refresh": 2,
+        "regex": "",
+        "sort": 1,
+        "type": "query"
+      },
+      {
+        "current": {
+          "text": "All",
+          "value": [
+            "$__all"
+          ]
+        },
+        "datasource": "TIYeHqRgZ",
+        "definition": "SHOW TAG VALUES FROM syslog WITH KEY=severity",
+        "includeAll": true,
+        "label": "Severity",
+        "multi": true,
+        "name": "severity",
+        "options": [],
+        "query": "SHOW TAG VALUES FROM syslog WITH KEY=severity",
+        "refresh": 2,
+        "regex": "",
+        "type": "query"
+      },
+      {
+        "current": {
+          "text": "",
+          "value": ""
+        },
+        "description": "Querystring",
+        "label": "MessageQuery",
+        "name": "Query",
+        "options": [
+          {
+            "selected": true,
+            "text": "",
+            "value": ""
+          }
+        ],
+        "query": "",
+        "type": "textbox"
+      }
+    ]
+  },
+  "time": {
+    "from": "now-1h",
+    "to": "now"
+  },
+  "timepicker": {
+    "refresh_intervals": [
+      "5s",
+      " 10s",
+      " 30s",
+      " 1m",
+      " 5m"
+    ]
+  },
+  "timezone": "",
+  "title": "Syslog",
+  "uid": "TIYeHqRgZ",
+  "version": 1,
+  "weekStart": ""
+}

changed: [davidayson8-3]
 __________________________________
< TASK [grafana : Copy mysql.json] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/ica0002/ica0002/roles/grafana/files/mysql.json
@@ -0,0 +1,510 @@
+{
+  "annotations": {
+    "list": [
+      {
+        "builtIn": 1,
+        "datasource": {
+          "type": "grafana",
+          "uid": "-- Grafana --"
+        },
+        "enable": true,
+        "hide": true,
+        "iconColor": "rgba(0, 211, 255, 1)",
+        "name": "Annotations & Alerts",
+        "type": "dashboard"
+      }
+    ]
+  },
+  "editable": true,
+  "fiscalYearStartMonth": 0,
+  "graphTooltip": 0,
+  "id": 4,
+  "links": [],
+  "panels": [
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 0,
+        "y": 0
+      },
+      "id": 1,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "datasource": {
+            "type": "prometheus",
+            "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+          },
+          "editorMode": "code",
+          "expr": "mysql_up",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Status",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "",
+            "axisPlacement": "auto",
+            "fillOpacity": 80,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "lineWidth": 1,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 12,
+        "y": 0
+      },
+      "id": 2,
+      "options": {
+        "barRadius": 0,
+        "barWidth": 0.97,
+        "fullHighlight": false,
+        "groupWidth": 0.7,
+        "legend": {
+          "calcs": [],
+          "displayMode": "list",
+          "placement": "bottom",
+          "showLegend": true
+        },
+        "orientation": "auto",
+        "showValue": "auto",
+        "stacking": "none",
+        "tooltip": {
+          "mode": "single",
+          "sort": "none"
+        },
+        "xTickLabelRotation": 0,
+        "xTickLabelSpacing": 0
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "rate(mysql_global_status_commands_total{command=\"select\"}[1m])",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Requests Per Min",
+      "type": "barchart"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 0,
+        "y": 8
+      },
+      "id": 3,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "mysql_global_variables_server_id",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Server IDs",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "thresholds"
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 12,
+        "y": 8
+      },
+      "id": 4,
+      "options": {
+        "colorMode": "value",
+        "graphMode": "area",
+        "justifyMode": "auto",
+        "orientation": "auto",
+        "percentChangeColorMode": "standard",
+        "reduceOptions": {
+          "calcs": [
+            "lastNotNull"
+          ],
+          "fields": "",
+          "values": false
+        },
+        "showPercentChange": false,
+        "textMode": "auto",
+        "wideLayout": true
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "mysql_global_variables_read_only",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Read Only Status",
+      "type": "stat"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "",
+            "axisPlacement": "auto",
+            "barAlignment": 0,
+            "barWidthFactor": 0.6,
+            "drawStyle": "line",
+            "fillOpacity": 0,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "insertNulls": false,
+            "lineInterpolation": "linear",
+            "lineWidth": 1,
+            "pointSize": 5,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "showPoints": "auto",
+            "spanNulls": false,
+            "stacking": {
+              "group": "A",
+              "mode": "none"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 0,
+        "y": 16
+      },
+      "id": 6,
+      "options": {
+        "legend": {
+          "calcs": [],
+          "displayMode": "list",
+          "placement": "bottom",
+          "showLegend": true
+        },
+        "tooltip": {
+          "mode": "single",
+          "sort": "none"
+        }
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "mysql_slave_status_slave_sql_running",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Replication Status (SQL)",
+      "type": "timeseries"
+    },
+    {
+      "datasource": {
+        "type": "prometheus",
+        "uid": "e91a23c9-c251-4690-aea4-62cc21dcfb51"
+      },
+      "fieldConfig": {
+        "defaults": {
+          "color": {
+            "mode": "palette-classic"
+          },
+          "custom": {
+            "axisBorderShow": false,
+            "axisCenteredZero": false,
+            "axisColorMode": "text",
+            "axisLabel": "",
+            "axisPlacement": "auto",
+            "barAlignment": 0,
+            "barWidthFactor": 0.6,
+            "drawStyle": "line",
+            "fillOpacity": 0,
+            "gradientMode": "none",
+            "hideFrom": {
+              "legend": false,
+              "tooltip": false,
+              "viz": false
+            },
+            "insertNulls": false,
+            "lineInterpolation": "linear",
+            "lineWidth": 1,
+            "pointSize": 5,
+            "scaleDistribution": {
+              "type": "linear"
+            },
+            "showPoints": "auto",
+            "spanNulls": false,
+            "stacking": {
+              "group": "A",
+              "mode": "none"
+            },
+            "thresholdsStyle": {
+              "mode": "off"
+            }
+          },
+          "mappings": [],
+          "thresholds": {
+            "mode": "absolute",
+            "steps": [
+              {
+                "color": "green",
+                "value": null
+              },
+              {
+                "color": "red",
+                "value": 80
+              }
+            ]
+          }
+        },
+        "overrides": []
+      },
+      "gridPos": {
+        "h": 8,
+        "w": 12,
+        "x": 12,
+        "y": 16
+      },
+      "id": 5,
+      "options": {
+        "legend": {
+          "calcs": [],
+          "displayMode": "list",
+          "placement": "bottom",
+          "showLegend": true
+        },
+        "tooltip": {
+          "mode": "single",
+          "sort": "none"
+        }
+      },
+      "pluginVersion": "11.4.0",
+      "targets": [
+        {
+          "editorMode": "code",
+          "expr": "mysql_slave_status_slave_io_running",
+          "legendFormat": "__auto",
+          "range": true,
+          "refId": "A"
+        }
+      ],
+      "title": "MySQL Replication Threads (IO)",
+      "type": "timeseries"
+    }
+  ],
+  "preload": false,
+  "schemaVersion": 40,
+  "tags": [],
+  "templating": {
+    "list": []
+  },
+  "time": {
+    "from": "now-6h",
+    "to": "now"
+  },
+  "timepicker": {},
+  "timezone": "browser",
+  "title": "MySQL",
+  "uid": "fe6vdzsuc5f5sf",
+  "version": 14,
+  "weekStart": ""
+}

changed: [davidayson8-3]
 ______________________________________
< TASK [grafana : Dashboards template] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpo4yb8d35/dashboards.yaml
@@ -0,0 +1,31 @@
+apiVersion: 1
+
+providers:
+  - name: 'Main'
+    orgId: 1
+    folder: ''
+    folderUid: ''
+    type: file
+    options:
+      path: /etc/grafana/provisioning/dashboards
+  - name: 'MySQL'
+    orgId: 1
+    folder: ''
+    folderUid: ''
+    type: file
+    options:
+      path: /etc/grafana/provisioning/dashboards
+  - name: 'Syslog'
+    orgId: 1
+    folder: ''
+    folderUid: ''
+    type: file
+    options:
+      path: /etc/grafana/provisioning/dashboards
+  - name: 'Backups'
+    orgId: 1
+    folder: ''
+    folderUid: ''
+    type: file
+    options:
+      path: /etc/grafana/provisioning/dashboards

changed: [davidayson8-3]
 _______________________________________
< TASK [grafana : Datasources template] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp98wrkz9x/datasources.yaml
@@ -0,0 +1,25 @@
+apiVersion: 1
+datasources:
+  - name: Prometheus
+    type: prometheus
+    access: proxy
+    orgId: 1
+    uid: e91a23c9-c251-4690-aea4-62cc21dcfb51
+    url: http://prometheus:9090/prometheus
+    isDefault: true
+    editable: true
+  - name: InfluxDB:agamaDB
+    type: influxdb
+    access: proxy
+    orgID: 1
+    uid: 1e2f45c9-a123-4690-bca5-34dc1adcb254
+    url: http://influxdb:8086
+    database: agamaDB
+  - name: InfluxDB:telegraf
+    type: influxdb
+    access: proxy
+    orgId: 1
+    uid: TIYeHqRgZ
+    url: http://influxdb:8086
+    database: telegraf
+

changed: [davidayson8-3]
 ___________________________________
< TASK [grafana : Grafana Template] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 ________________________________________________
< TASK [grafana : Create Grafana data container] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,4 +1,4 @@
 {
-    "exists": false,
-    "running": false
+    "exists": true,
+    "running": true
 }

changed: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 _______________________________________________
< RUNNING HANDLER [grafana : Restart container] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,4 +1,4 @@
 {
-    "restarted": false,
+    "restarted": true,
     "running": true
 }

changed: [davidayson8-3]
 ______________________________
< PLAY [Database server setup] >
 ------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________
< TASK [mysql : Install MySQL server] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  libcgi-fast-perl libcgi-pm-perl libclone-perl libencode-locale-perl
  libevent-pthreads-2.1-7 libfcgi-bin libfcgi-perl libfcgi0ldbl
  libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl
  libhttp-date-perl libhttp-message-perl libio-html-perl
  liblwp-mediatypes-perl libmecab2 libprotobuf-lite23 liburi-perl mecab-ipadic
  mecab-ipadic-utf8 mecab-utils mysql-client-8.0 mysql-client-core-8.0
  mysql-common mysql-server-8.0 mysql-server-core-8.0
Suggested packages:
  libdata-dump-perl libipc-sharedcache-perl libbusiness-isbn-perl libwww-perl
  mailx tinyca python-pymysql-doc
The following NEW packages will be installed:
  libcgi-fast-perl libcgi-pm-perl libclone-perl libencode-locale-perl
  libevent-pthreads-2.1-7 libfcgi-bin libfcgi-perl libfcgi0ldbl
  libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl
  libhttp-date-perl libhttp-message-perl libio-html-perl
  liblwp-mediatypes-perl libmecab2 libprotobuf-lite23 liburi-perl mecab-ipadic
  mecab-ipadic-utf8 mecab-utils mysql-client-8.0 mysql-client-core-8.0
  mysql-common mysql-server mysql-server-8.0 mysql-server-core-8.0
  prometheus-mysqld-exporter python3-pymysql
0 upgraded, 29 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
The following additional packages will be installed:
  libcgi-fast-perl libcgi-pm-perl libclone-perl libencode-locale-perl
  libevent-pthreads-2.1-7 libfcgi-bin libfcgi-perl libfcgi0ldbl
  libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl
  libhttp-date-perl libhttp-message-perl libio-html-perl
  liblwp-mediatypes-perl libmecab2 libprotobuf-lite23 liburi-perl mecab-ipadic
  mecab-ipadic-utf8 mecab-utils mysql-client-8.0 mysql-client-core-8.0
  mysql-common mysql-server-8.0 mysql-server-core-8.0
Suggested packages:
  libdata-dump-perl libipc-sharedcache-perl libbusiness-isbn-perl libwww-perl
  mailx tinyca python-pymysql-doc
The following NEW packages will be installed:
  libcgi-fast-perl libcgi-pm-perl libclone-perl libencode-locale-perl
  libevent-pthreads-2.1-7 libfcgi-bin libfcgi-perl libfcgi0ldbl
  libhtml-parser-perl libhtml-tagset-perl libhtml-template-perl
  libhttp-date-perl libhttp-message-perl libio-html-perl
  liblwp-mediatypes-perl libmecab2 libprotobuf-lite23 liburi-perl mecab-ipadic
  mecab-ipadic-utf8 mecab-utils mysql-client-8.0 mysql-client-core-8.0
  mysql-common mysql-server mysql-server-8.0 mysql-server-core-8.0
  prometheus-mysqld-exporter python3-pymysql
0 upgraded, 29 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
 ________________________________________________
< TASK [mysql : Add MySQL bind address override] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp9c6rusc8/override.cnf.j2
@@ -0,0 +1,6 @@
+[mysqld]
+bind-address = 0.0.0.0
+log-bin = /var/log/mysql/mysql-bin.log
+relay-log = /var/log/mysql/mysql-relay.log
+replicate-do-db = agama
+server-id = 428

changed: [davidayson8-2]
--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmphi4xxasn/override.cnf.j2
@@ -0,0 +1,6 @@
+[mysqld]
+bind-address = 0.0.0.0
+log-bin = /var/log/mysql/mysql-bin.log
+relay-log = /var/log/mysql/mysql-relay.log
+replicate-do-db = agama
+server-id = 321

changed: [davidayson8-1]
 ____________________________________________________
< TASK [mysql : Ensure MySQL is running and enabled] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________
< TASK [mysql : MySQL database] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 __________________________________
< TASK [mysql : Create MySQL user] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ___________________________________________
< TASK [mysql : Create MySQL Exporter user] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 ____________________________________________________
/ TASK [mysql : Passing authentication data to MySQL \
\ Exporter]                                          /
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 _________________________________________________
< TASK [mysql : Run prometheus exporter template] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/default/prometheus-mysqld-exporter
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpub87hb_p/mysql_metric.yaml.j2
@@ -1,192 +1 @@
-### Set the command-line arguments to pass to the server.
-#
-# See below for a full list of available arguments.
-#
-# Due to shell scaping, to pass backslashes for regexes, you need to double
-# them (\\d for \d). If running under systemd, you need to double them again
-# (\\\\d to mean \d), and escape newlines too.
-ARGS=""
-
-
-### Database authentication
-#
-# By default the DATABASE connection string will be read from
-# the file specified with the -config.my-cnf parameter.  For example:
-# ARGS='--config.my-cnf /etc/mysql/debian.cnf'
-#
-# Note that SSL options can only be set using a cnf file.
-
-# To set a connection string from the environment instead, set the
-# DATA_SOURCE_NAME variable.
-
-# To use UNIX domain sockets authentication with or without password:
-# DATA_SOURCE_NAME="prometheus:nopassword@unix(/run/mysqld/mysqld.sock)/"
-# DATA_SOURCE_NAME="prometheus@unix(/run/mysqld/mysqld.sock)/"
-
-# To use a TCP connection and password authentication:
-# DATA_SOURCE_NAME="prometheus:password@(hostname:port)/dbname"
-
-### Monitoring user creation.
-#
-# You need a user with enough privileges for the exporter to run.
-#
-# Example to create a user to connect (only) via UNIX socket:
-#   CREATE USER IF NOT EXISTS 'prometheus'@'localhost' IDENTIFIED WITH auth_socket;
-#
-# To create a user with a password, that can log in via UNIX or TCP sockets:
-#   CREATE USER IF NOT EXISTS 'prometheus'@'localhost' IDENTIFIED BY 'password';
-#
-# Finally, to grant the necessary privileges:
-#   GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'prometheus'@'localhost';
-
-### Availabe command-line arguments to pass to the exporter.
-#
-# General options:
-
-#  --config.my-cnf="${HOME}/.my.cnf"
-#      Path to .my.cnf file to read MySQL credentials from.
-#  --exporter.lock_wait_timeout=2
-#      Set a lock_wait_timeout on the connection to avoid long metadata
-#      locking.
-#  --exporter.log_slow_filter
-#      Add a log_slow_filter to avoid slow query logging of scrapes.
-#      NOTE: Not supported by Oracle MySQL.
-#  --log.level="info"
-#      Only log messages with the given severity or above.
-#      Valid levels: [debug, info, warn, error, fatal].
-#  --log.format="logger:stderr"
-#      Set the log target and format.
-#      Example: "logger:syslog?appname=bob&local=7" or
-#      "logger:stdout?json=true"
-#  --timeout-offset=0.25
-#      Offset to subtract from timeout in seconds.
-#  --web.listen-address=":9104"
-#      Address to listen on for web interface and telemetry.
-#  --web.telemetry-path="/metrics"
-#      Path under which to expose metrics.
-
-# Collectior options:
-
-#  --collect.auto_increment.columns
-#      Collect auto_increment columns and max values from information_schema.
-#  --collect.binlog_size
-#      Collect the current size of all registered binlog files.
-
-#  --collect.engine_innodb_status
-#      Collect from SHOW ENGINE INNODB STATUS.
-
-#  --collect.engine_tokudb_status
-#      Collect from SHOW ENGINE TOKUDB STATUS.
-
-#  --collect.global_status
-#      Collect from SHOW GLOBAL STATUS.
-
-#  --collect.global_variables
-#      Collect from SHOW GLOBAL VARIABLES.
-
-#  --collect.heartbeat
-#      Collect from heartbeat.
-#  --collect.heartbeat.database="heartbeat"
-#      Database from where to collect heartbeat data.
-#  --collect.heartbeat.table="heartbeat"
-#      Table from where to collect heartbeat data.
-
-#  --collect.info_schema.clientstats
-#      If running with userstat=1, set to true to collect client statistics.
-
-#  --collect.info_schema.innodb_cmp
-#      Collect metrics from information_schema.innodb_cmp.
-
-#  --collect.info_schema.innodb_cmpmem
-#      Collect metrics from information_schema.innodb_cmpmem.
-
-#  --collect.info_schema.innodb_metrics
-#      Collect metrics from information_schema.innodb_metrics.
-
-#  --collect.info_schema.innodb_tablespaces
-#      Collect metrics from information_schema.innodb_sys_tablespaces.
-
-#  --collect.info_schema.processlist
-#      Collect current thread state counts from the
-#      information_schema.processlist.
-#  --collect.info_schema.processlist.min_time=0
-#      Minimum time a thread must be in each state to be counted.
-#  --collect.info_schema.processlist.processes_by_host
-#      Enable collecting the number of processes by host.
-#  --collect.info_schema.processlist.processes_by_user
-#      Enable collecting the number of processes by user.
-
-#  --collect.info_schema.query_response_time
-#      Collect query response time distribution if query_response_time_stats is
-#      ON..
-
-#  --collect.info_schema.schemastats
-#      If running with userstat=1, set to true to collect schema statistics.
-
-#  --collect.info_schema.tables
-#      Collect metrics from information_schema.tables.
-#  --collect.info_schema.tables.databases="*"
-#      The list of databases to collect table stats for, or '*' for all.
-
-#  --collect.info_schema.tablestats
-#      If running with userstat=1, set to true to collect table statistics.
-
-#  --collect.info_schema.userstats
-#      If running with userstat=1, set to true to collect user statistics.
-
-#  --collect.mysql.user
-#      Collect data from mysql.user
-#  --collect.mysql.user.privileges
-#      Enable collecting user privileges from mysql.user.
-
-#  --collect.perf_schema.eventsstatements
-#      Collect metrics from
-#      performance_schema.events_statements_summary_by_digest.
-#  --collect.perf_schema.eventsstatements.digest_text_limit=120
-#      Maximum length of the normalized statement text.
-#  --collect.perf_schema.eventsstatements.limit=250
-#      Limit the number of events statements digests by response time.
-#  --collect.perf_schema.eventsstatements.timelimit=86400
-#      Limit how old the 'last_seen' events statements can be, in seconds.
-
-#  --collect.perf_schema.eventsstatementssum
-#      Collect metrics of grand sums from
-#      performance_schema.events_statements_summary_by_digest.
-
-#  --collect.perf_schema.eventswaits
-#      Collect metrics from
-#      performance_schema.events_waits_summary_global_by_event_name.
-
-#  --collect.perf_schema.file_events
-#      Collect metrics from performance_schema.file_summary_by_event_name.
-
-#  --collect.perf_schema.file_instances
-#      Collect metrics from performance_schema.file_summary_by_instance.
-#  --collect.perf_schema.file_instances.filter=".*"
-#      RegEx file_name filter for performance_schema.file_summary_by_instance.
-#  --collect.perf_schema.file_instances.remove_prefix="/var/lib/mysql/"
-#      Remove path prefix in performance_schema.file_summary_by_instance.
-
-#  --collect.perf_schema.indexiowaits
-#      Collect metrics from
-#      performance_schema.table_io_waits_summary_by_index_usage.
-
-#  --collect.perf_schema.replication_applier_status_by_worker
-#      Collect metrics from
-#      performance_schema.replication_applier_status_by_worker.
-
-#  --collect.perf_schema.replication_group_member_stats
-#      Collect metrics from performance_schema.replication_group_member_stats.
-
-#  --collect.perf_schema.tableiowaits
-#      Collect metrics from performance_schema.table_io_waits_summary_by_table.
-
-#  --collect.perf_schema.tablelocks
-#      Collect metrics from
-#      performance_schema.table_lock_waits_summary_by_table.
-
-#  --collect.slave_hosts
-#      Scrape information from 'SHOW SLAVE HOSTS'.
-
-#  --collect.slave_status
-#      Collect from SHOW SLAVE STATUS.
+ARGS="--collect.slave_status"

changed: [davidayson8-2]
--- before: /etc/default/prometheus-mysqld-exporter
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpwdqw1205/mysql_metric.yaml.j2
@@ -1,192 +1 @@
-### Set the command-line arguments to pass to the server.
-#
-# See below for a full list of available arguments.
-#
-# Due to shell scaping, to pass backslashes for regexes, you need to double
-# them (\\d for \d). If running under systemd, you need to double them again
-# (\\\\d to mean \d), and escape newlines too.
-ARGS=""
-
-
-### Database authentication
-#
-# By default the DATABASE connection string will be read from
-# the file specified with the -config.my-cnf parameter.  For example:
-# ARGS='--config.my-cnf /etc/mysql/debian.cnf'
-#
-# Note that SSL options can only be set using a cnf file.
-
-# To set a connection string from the environment instead, set the
-# DATA_SOURCE_NAME variable.
-
-# To use UNIX domain sockets authentication with or without password:
-# DATA_SOURCE_NAME="prometheus:nopassword@unix(/run/mysqld/mysqld.sock)/"
-# DATA_SOURCE_NAME="prometheus@unix(/run/mysqld/mysqld.sock)/"
-
-# To use a TCP connection and password authentication:
-# DATA_SOURCE_NAME="prometheus:password@(hostname:port)/dbname"
-
-### Monitoring user creation.
-#
-# You need a user with enough privileges for the exporter to run.
-#
-# Example to create a user to connect (only) via UNIX socket:
-#   CREATE USER IF NOT EXISTS 'prometheus'@'localhost' IDENTIFIED WITH auth_socket;
-#
-# To create a user with a password, that can log in via UNIX or TCP sockets:
-#   CREATE USER IF NOT EXISTS 'prometheus'@'localhost' IDENTIFIED BY 'password';
-#
-# Finally, to grant the necessary privileges:
-#   GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'prometheus'@'localhost';
-
-### Availabe command-line arguments to pass to the exporter.
-#
-# General options:
-
-#  --config.my-cnf="${HOME}/.my.cnf"
-#      Path to .my.cnf file to read MySQL credentials from.
-#  --exporter.lock_wait_timeout=2
-#      Set a lock_wait_timeout on the connection to avoid long metadata
-#      locking.
-#  --exporter.log_slow_filter
-#      Add a log_slow_filter to avoid slow query logging of scrapes.
-#      NOTE: Not supported by Oracle MySQL.
-#  --log.level="info"
-#      Only log messages with the given severity or above.
-#      Valid levels: [debug, info, warn, error, fatal].
-#  --log.format="logger:stderr"
-#      Set the log target and format.
-#      Example: "logger:syslog?appname=bob&local=7" or
-#      "logger:stdout?json=true"
-#  --timeout-offset=0.25
-#      Offset to subtract from timeout in seconds.
-#  --web.listen-address=":9104"
-#      Address to listen on for web interface and telemetry.
-#  --web.telemetry-path="/metrics"
-#      Path under which to expose metrics.
-
-# Collectior options:
-
-#  --collect.auto_increment.columns
-#      Collect auto_increment columns and max values from information_schema.
-#  --collect.binlog_size
-#      Collect the current size of all registered binlog files.
-
-#  --collect.engine_innodb_status
-#      Collect from SHOW ENGINE INNODB STATUS.
-
-#  --collect.engine_tokudb_status
-#      Collect from SHOW ENGINE TOKUDB STATUS.
-
-#  --collect.global_status
-#      Collect from SHOW GLOBAL STATUS.
-
-#  --collect.global_variables
-#      Collect from SHOW GLOBAL VARIABLES.
-
-#  --collect.heartbeat
-#      Collect from heartbeat.
-#  --collect.heartbeat.database="heartbeat"
-#      Database from where to collect heartbeat data.
-#  --collect.heartbeat.table="heartbeat"
-#      Table from where to collect heartbeat data.
-
-#  --collect.info_schema.clientstats
-#      If running with userstat=1, set to true to collect client statistics.
-
-#  --collect.info_schema.innodb_cmp
-#      Collect metrics from information_schema.innodb_cmp.
-
-#  --collect.info_schema.innodb_cmpmem
-#      Collect metrics from information_schema.innodb_cmpmem.
-
-#  --collect.info_schema.innodb_metrics
-#      Collect metrics from information_schema.innodb_metrics.
-
-#  --collect.info_schema.innodb_tablespaces
-#      Collect metrics from information_schema.innodb_sys_tablespaces.
-
-#  --collect.info_schema.processlist
-#      Collect current thread state counts from the
-#      information_schema.processlist.
-#  --collect.info_schema.processlist.min_time=0
-#      Minimum time a thread must be in each state to be counted.
-#  --collect.info_schema.processlist.processes_by_host
-#      Enable collecting the number of processes by host.
-#  --collect.info_schema.processlist.processes_by_user
-#      Enable collecting the number of processes by user.
-
-#  --collect.info_schema.query_response_time
-#      Collect query response time distribution if query_response_time_stats is
-#      ON..
-
-#  --collect.info_schema.schemastats
-#      If running with userstat=1, set to true to collect schema statistics.
-
-#  --collect.info_schema.tables
-#      Collect metrics from information_schema.tables.
-#  --collect.info_schema.tables.databases="*"
-#      The list of databases to collect table stats for, or '*' for all.
-
-#  --collect.info_schema.tablestats
-#      If running with userstat=1, set to true to collect table statistics.
-
-#  --collect.info_schema.userstats
-#      If running with userstat=1, set to true to collect user statistics.
-
-#  --collect.mysql.user
-#      Collect data from mysql.user
-#  --collect.mysql.user.privileges
-#      Enable collecting user privileges from mysql.user.
-
-#  --collect.perf_schema.eventsstatements
-#      Collect metrics from
-#      performance_schema.events_statements_summary_by_digest.
-#  --collect.perf_schema.eventsstatements.digest_text_limit=120
-#      Maximum length of the normalized statement text.
-#  --collect.perf_schema.eventsstatements.limit=250
-#      Limit the number of events statements digests by response time.
-#  --collect.perf_schema.eventsstatements.timelimit=86400
-#      Limit how old the 'last_seen' events statements can be, in seconds.
-
-#  --collect.perf_schema.eventsstatementssum
-#      Collect metrics of grand sums from
-#      performance_schema.events_statements_summary_by_digest.
-
-#  --collect.perf_schema.eventswaits
-#      Collect metrics from
-#      performance_schema.events_waits_summary_global_by_event_name.
-
-#  --collect.perf_schema.file_events
-#      Collect metrics from performance_schema.file_summary_by_event_name.
-
-#  --collect.perf_schema.file_instances
-#      Collect metrics from performance_schema.file_summary_by_instance.
-#  --collect.perf_schema.file_instances.filter=".*"
-#      RegEx file_name filter for performance_schema.file_summary_by_instance.
-#  --collect.perf_schema.file_instances.remove_prefix="/var/lib/mysql/"
-#      Remove path prefix in performance_schema.file_summary_by_instance.
-
-#  --collect.perf_schema.indexiowaits
-#      Collect metrics from
-#      performance_schema.table_io_waits_summary_by_index_usage.
-
-#  --collect.perf_schema.replication_applier_status_by_worker
-#      Collect metrics from
-#      performance_schema.replication_applier_status_by_worker.
-
-#  --collect.perf_schema.replication_group_member_stats
-#      Collect metrics from performance_schema.replication_group_member_stats.
-
-#  --collect.perf_schema.tableiowaits
-#      Collect metrics from performance_schema.table_io_waits_summary_by_table.
-
-#  --collect.perf_schema.tablelocks
-#      Collect metrics from
-#      performance_schema.table_lock_waits_summary_by_table.
-
-#  --collect.slave_hosts
-#      Scrape information from 'SHOW SLAVE HOSTS'.
-
-#  --collect.slave_status
-#      Collect from SHOW SLAVE STATUS.
+ARGS="--collect.slave_status"

changed: [davidayson8-1]
 _____________________________________________________________
< TASK [mysql : Ensure the MySQL Exporter service is started] >
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ____________________________________________________
< TASK [mysql : Create /home/backup/mysql directory] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,6 +1,6 @@
 {
-    "group": 0,
-    "owner": 0,
+    "group": 34,
+    "owner": 34,
     "path": "/home/backup/mysql",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-2]
--- before
+++ after
@@ -1,6 +1,6 @@
 {
-    "group": 0,
-    "owner": 0,
+    "group": 34,
+    "owner": 34,
     "path": "/home/backup/mysql",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-1]
 _______________________________________________
< TASK [mysql : Ensure MySQL backup user exist] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 _______________________________________
< TASK [mysql : Create backup template] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ___________________________________
< TASK [mysql : Create Cron Backup] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ____________________________________________________
< TASK [mysql : Ensure MySQL replication user exist] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 _________________________________________________
< TASK [mysql : Handles dynamic MySQL parameters] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 _________________________________________
< RUNNING HANDLER [mysql : Restart MySQL] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 __________________________________________________
< RUNNING HANDLER [mysql : Restart MySQL Exporter] >
 --------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ________________________________________
< RUNNING HANDLER [mysql : Restart cron] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-1]
changed: [davidayson8-2]
 ______________________________________________
< RUNNING HANDLER [mysql : Reset MySQL source] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-2] => (item=stopreplica) 
skipping: [davidayson8-2] => (item=resetprimary) 
skipping: [davidayson8-2]
changed: [davidayson8-1] => (item=stopreplica)
changed: [davidayson8-1] => (item=resetprimary)
 _______________________________________________
< RUNNING HANDLER [mysql : Reset MySQL replica] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1]
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2]
 _________________
< PLAY [InfluxDB] >
 -----------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________
< TASK [influxdb : Install InfluxDB] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following NEW packages will be installed:
  influxdb
0 upgraded, 1 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-3]
 __________________________________________________________
< TASK [influxdb : Ensure InfluxDB is started and enabled] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________
< TASK [influxdb : Make dir for apt key] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________
< TASK [influxdb : Install Telegraf Repo Key] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 _____________________________________
< TASK [influxdb : Add Telegraf Repo] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /dev/null
+++ after: /etc/apt/sources.list.d/repos_influxdata_com_debian.list
@@ -0,0 +1 @@
+deb [signed-by=/etc/apt/keyrings/telegraf.asc] https://repos.influxdata.com/debian stable main

changed: [davidayson8-3]
 ____________________________________
< TASK [influxdb : Install Telegraf] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following NEW packages will be installed:
  telegraf
0 upgraded, 1 newly installed, 0 to remove and 132 not upgraded.
changed: [davidayson8-3]
 _________________________________________
< TASK [influxdb : Run Telegraf template] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

diff skipped: destination file size is greater than 104448
changed: [davidayson8-3]
 _____________________________________________________________
< TASK [influxdb : Make sure Telegraf is enabled and running] >
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 __________________________________________________
< TASK [influxdb : Install InfluxDB Stat Exporter] >
 --------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 ______________________________________________________
< TASK [influxdb : Import Influxdb Stat Expo Template] >
 ------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpxhb24l3w/influx_stat_expo.service
@@ -0,0 +1,11 @@
+[Unit]
+Description=Prometheus InfluxDB Statistic Exporter
+Documentation=https://github.com/carlpett/influxdb_stats_exporter
+After=network-online.target
+
+[Service]
+User=prometheus
+ExecStart=/usr/local/bin/influxdb_stats_exporter_linux_amd64
+
+[Install]
+WantedBy=multi-user.target 

changed: [davidayson8-3]
 _________________________________________________
< TASK [influxdb : Import Influxdb Conf Template] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/influxdb/influxdb.conf
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmptepb2syq/influxdb.conf
@@ -1,556 +1,11 @@
-### Welcome to the InfluxDB configuration file.
-
-# The values in this file override the default values used by the system if
-# a config option is not specified. The commented out lines are the configuration
-# field and the default value used. Uncommenting a line and changing the value
-# will change the value used at runtime when the process is restarted.
-
-# Once every 24 hours InfluxDB will report usage data to usage.influxdata.com
-# The data includes a random ID, os, arch, version, the number of series and other
-# usage data. No data from user databases is ever transmitted.
-# Change this option to true to enable reporting.
-reporting-enabled = false
-
-# Bind address to use for the RPC service for backup and restore.
-# bind-address = "127.0.0.1:8088"
-
-###
-### [meta]
-###
-### Controls the parameters for the Raft consensus group that stores metadata
-### about the InfluxDB cluster.
-###
-
 [meta]
-  # Where the metadata/raft database is stored
   dir = "/var/lib/influxdb/meta"
-
-  # Automatically create a default retention policy when creating a database.
-  # retention-autocreate = true
-
-  # If log messages are printed for the meta service
-  # logging-enabled = true
-
-###
-### [data]
-###
-### Controls where the actual shard data for InfluxDB lives and how it is
-### flushed from the WAL. "dir" may need to be changed to a suitable place
-### for your system, but the WAL settings are an advanced configuration. The
-### defaults should work for most systems.
-###
-
 [data]
-  # The directory where the TSM storage engine stores TSM files.
   dir = "/var/lib/influxdb/data"
-
-  # The directory where the TSM storage engine stores WAL files.
   wal-dir = "/var/lib/influxdb/wal"
-
-  # The amount of time that a write will wait before fsyncing.  A duration
-  # greater than 0 can be used to batch up multiple fsync calls.  This is useful for slower
-  # disks or when WAL write contention is seen.  A value of 0s fsyncs every write to the WAL.
-  # Values in the range of 0-100ms are recommended for non-SSD disks.
-  # wal-fsync-delay = "0s"
-
-
-  # The type of shard index to use for new shards.  The default is an in-memory index that is
-  # recreated at startup.  A value of "tsi1" will use a disk based index that supports higher
-  # cardinality datasets.
-  # index-version = "inmem"
-
-  # Trace logging provides more verbose output around the tsm engine. Turning
-  # this on can provide more useful output for debugging tsm engine issues.
-  # trace-logging-enabled = false
-
-  # Whether queries should be logged before execution. Very useful for troubleshooting, but will
-  # log any sensitive data contained within a query.
-  # query-log-enabled = true
-
-  # Settings for the TSM engine
-
-  # CacheMaxMemorySize is the maximum size a shard's cache can
-  # reach before it starts rejecting writes.
-  # Valid size suffixes are k, m, or g (case insensitive, 1024 = 1k).
-  # Values without a size suffix are in bytes.
-  # cache-max-memory-size = "1g"
-
-  # CacheSnapshotMemorySize is the size at which the engine will
-  # snapshot the cache and write it to a TSM file, freeing up memory
-  # Valid size suffixes are k, m, or g (case insensitive, 1024 = 1k).
-  # Values without a size suffix are in bytes.
-  # cache-snapshot-memory-size = "25m"
-
-  # CacheSnapshotWriteColdDuration is the length of time at
-  # which the engine will snapshot the cache and write it to
-  # a new TSM file if the shard hasn't received writes or deletes
-  # cache-snapshot-write-cold-duration = "10m"
-
-  # CompactFullWriteColdDuration is the duration at which the engine
-  # will compact all TSM files in a shard if it hasn't received a
-  # write or delete
-  # compact-full-write-cold-duration = "4h"
-
-  # The maximum number of concurrent full and level compactions that can run at one time.  A
-  # value of 0 results in 50% of runtime.GOMAXPROCS(0) used at runtime.  Any number greater
-  # than 0 limits compactions to that value.  This setting does not apply
-  # to cache snapshotting.
-  # max-concurrent-compactions = 0
-
-  # The threshold, in bytes, when an index write-ahead log file will compact
-  # into an index file. Lower sizes will cause log files to be compacted more
-  # quickly and result in lower heap usage at the expense of write throughput.
-  # Higher sizes will be compacted less frequently, store more series in-memory,
-  # and provide higher write throughput.
-  # Valid size suffixes are k, m, or g (case insensitive, 1024 = 1k).
-  # Values without a size suffix are in bytes.
-  # max-index-log-file-size = "1m"
-
-  # The maximum series allowed per database before writes are dropped.  This limit can prevent
-  # high cardinality issues at the database level.  This limit can be disabled by setting it to
-  # 0.
-  # max-series-per-database = 1000000
-
-  # The maximum number of tag values per tag that are allowed before writes are dropped.  This limit
-  # can prevent high cardinality tag values from being written to a measurement.  This limit can be
-  # disabled by setting it to 0.
-  # max-values-per-tag = 100000
-
-  # If true, then the mmap advise value MADV_WILLNEED will be provided to the kernel with respect to
-  # TSM files. This setting has been found to be problematic on some kernels, and defaults to off.
-  # It might help users who have slow disks in some cases.
-  # tsm-use-madv-willneed = false
-
-###
-### [coordinator]
-###
-### Controls the clustering service configuration.
-###
-
-[coordinator]
-  # The default time a write request will wait until a "timeout" error is returned to the caller.
-  # write-timeout = "10s"
-
-  # The maximum number of concurrent queries allowed to be executing at one time.  If a query is
-  # executed and exceeds this limit, an error is returned to the caller.  This limit can be disabled
-  # by setting it to 0.
-  # max-concurrent-queries = 0
-
-  # The maximum time a query will is allowed to execute before being killed by the system.  This limit
-  # can help prevent run away queries.  Setting the value to 0 disables the limit.
-  # query-timeout = "0s"
-
-  # The time threshold when a query will be logged as a slow query.  This limit can be set to help
-  # discover slow or resource intensive queries.  Setting the value to 0 disables the slow query logging.
-  # log-queries-after = "0s"
-
-  # The maximum number of points a SELECT can process.  A value of 0 will make
-  # the maximum point count unlimited.  This will only be checked every second so queries will not
-  # be aborted immediately when hitting the limit.
-  # max-select-point = 0
-
-  # The maximum number of series a SELECT can run.  A value of 0 will make the maximum series
-  # count unlimited.
-  # max-select-series = 0
-
-  # The maxium number of group by time bucket a SELECT can create.  A value of zero will max the maximum
-  # number of buckets unlimited.
-  # max-select-buckets = 0
-
-###
-### [retention]
-###
-### Controls the enforcement of retention policies for evicting old data.
-###
-
-[retention]
-  # Determines whether retention policy enforcement enabled.
-  # enabled = true
-
-  # The interval of time when retention policy enforcement checks run.
-  # check-interval = "30m"
-
-###
-### [shard-precreation]
-###
-### Controls the precreation of shards, so they are available before data arrives.
-### Only shards that, after creation, will have both a start- and end-time in the
-### future, will ever be created. Shards are never precreated that would be wholly
-### or partially in the past.
-
-[shard-precreation]
-  # Determines whether shard pre-creation service is enabled.
-  # enabled = true
-
-  # The interval of time when the check to pre-create new shards runs.
-  # check-interval = "10m"
-
-  # The default period ahead of the endtime of a shard group that its successor
-  # group is created.
-  # advance-period = "30m"
-
-###
-### Controls the system self-monitoring, statistics and diagnostics.
-###
-### The internal database for monitoring data is created automatically if
-### if it does not already exist. The target retention within this database
-### is called 'monitor' and is also created with a retention period of 7 days
-### and a replication factor of 1, if it does not exist. In all cases the
-### this retention policy is configured as the default for the database.
-
-[monitor]
-  # Whether to record statistics internally.
-  # store-enabled = true
-
-  # The destination database for recorded statistics
-  # store-database = "_internal"
-
-  # The interval at which to record statistics
-  # store-interval = "10s"
-
-###
-### [http]
-###
-### Controls how the HTTP endpoints are configured. These are the primary
-### mechanism for getting data into and out of InfluxDB.
-###
-
+  series-id-set-cache-size = 100
+  query-log-enabled = false
 [http]
-  # Determines whether HTTP endpoint is enabled.
-  # enabled = true
-
-  # The bind address used by the HTTP service.
-  # bind-address = ":8086"
-
-  # Determines whether user authentication is enabled over HTTP/HTTPS.
-  # auth-enabled = false
-
-  # The default realm sent back when issuing a basic auth challenge.
-  # realm = "InfluxDB"
-
-  # Determines whether HTTP request logging is enabled.
-  # log-enabled = true
-
-  # Determines whether the HTTP write request logs should be suppressed when the log is enabled.
-  # suppress-write-log = false
-
-  # When HTTP request logging is enabled, this option specifies the path where
-  # log entries should be written. If unspecified, the default is to write to stderr, which
-  # intermingles HTTP logs with internal InfluxDB logging.
-  #
-  # If influxd is unable to access the specified path, it will log an error and fall back to writing
-  # the request log to stderr.
-  # access-log-path = ""
-
-  # Determines whether detailed write logging is enabled.
-  # write-tracing = false
-
-  # Determines whether the pprof endpoint is enabled.  This endpoint is used for
-  # troubleshooting and monitoring.
-  # pprof-enabled = true
-
-  # Enables a pprof endpoint that binds to localhost:6060 immediately on startup.
-  # This is only needed to debug startup issues.
-  # debug-pprof-enabled = false
-
-  # Determines whether HTTPS is enabled.
-  # https-enabled = false
-
-  # The SSL certificate to use when HTTPS is enabled.
-  # https-certificate = "/etc/ssl/influxdb.pem"
-
-  # Use a separate private key location.
-  # https-private-key = ""
-
-  # The JWT auth shared secret to validate requests using JSON web tokens.
-  # shared-secret = ""
-
-  # The default chunk size for result sets that should be chunked.
-  # max-row-limit = 0
-
-  # The maximum number of HTTP connections that may be open at once.  New connections that
-  # would exceed this limit are dropped.  Setting this value to 0 disables the limit.
-  # max-connection-limit = 0
-
-  # Enable http service over unix domain socket
-  # unix-socket-enabled = false
-
-  # The path of the unix domain socket.
-  # bind-socket = "/var/run/influxdb.sock"
-
-  # The maximum size of a client request body, in bytes. Setting this value to 0 disables the limit.
-  # max-body-size = 25000000
-
-  # The maximum number of writes processed concurrently.
-  # Setting this to 0 disables the limit.
-  # max-concurrent-write-limit = 0
-
-  # The maximum number of writes queued for processing.
-  # Setting this to 0 disables the limit.
-  # max-enqueued-write-limit = 0
-
-  # The maximum duration for a write to wait in the queue to be processed.
-  # Setting this to 0 or setting max-concurrent-write-limit to 0 disables the limit.
-  # enqueued-write-timeout = 0
-
-
-###
-### [ifql]
-###
-### Configures the ifql RPC API.
-###
-
-[ifql]
-  # Determines whether the RPC service is enabled.
-  # enabled = true
-
-  # Determines whether additional logging is enabled.
-  # log-enabled = true
-
-  # The bind address used by the ifql RPC service.
-  # bind-address = ":8082"
-
-
-###
-### [logging]
-###
-### Controls how the logger emits logs to the output.
-###
-
-[logging]
-  # Determines which log encoder to use for logs. Available options
-  # are auto, logfmt, and json. auto will use a more a more user-friendly
-  # output format if the output terminal is a TTY, but the format is not as
-  # easily machine-readable. When the output is a non-TTY, auto will use
-  # logfmt.
-  # format = "auto"
-
-  # Determines which level of logs will be emitted. The available levels
-  # are error, warn, info, and debug. Logs that are equal to or above the
-  # specified level will be emitted.
-  # level = "info"
-
-  # Suppresses the logo output that is printed when the program is started.
-  # The logo is always suppressed if STDOUT is not a TTY.
-  # suppress-logo = false
-
-###
-### [subscriber]
-###
-### Controls the subscriptions, which can be used to fork a copy of all data
-### received by the InfluxDB host.
-###
-
-[subscriber]
-  # Determines whether the subscriber service is enabled.
-  # enabled = true
-
-  # The default timeout for HTTP writes to subscribers.
-  # http-timeout = "30s"
-
-  # Allows insecure HTTPS connections to subscribers.  This is useful when testing with self-
-  # signed certificates.
-  # insecure-skip-verify = false
-
-  # The path to the PEM encoded CA certs file. If the empty string, the default system certs will be used
-  # ca-certs = ""
-
-  # The number of writer goroutines processing the write channel.
-  # write-concurrency = 40
-
-  # The number of in-flight writes buffered in the write channel.
-  # write-buffer-size = 1000
-
-
-###
-### [[graphite]]
-###
-### Controls one or many listeners for Graphite data.
-###
-
-[[graphite]]
-  # Determines whether the graphite endpoint is enabled.
-  # enabled = false
-  # database = "graphite"
-  # retention-policy = ""
-  # bind-address = ":2003"
-  # protocol = "tcp"
-  # consistency-level = "one"
-
-  # These next lines control how batching works. You should have this enabled
-  # otherwise you could get dropped metrics or poor performance. Batching
-  # will buffer points in memory if you have many coming in.
-
-  # Flush if this many points get buffered
-  # batch-size = 5000
-
-  # number of batches that may be pending in memory
-  # batch-pending = 10
-
-  # Flush at least this often even if we haven't hit buffer limit
-  # batch-timeout = "1s"
-
-  # UDP Read buffer size, 0 means OS default. UDP listener will fail if set above OS max.
-  # udp-read-buffer = 0
-
-  ### This string joins multiple matching 'measurement' values providing more control over the final measurement name.
-  # separator = "."
-
-  ### Default tags that will be added to all metrics.  These can be overridden at the template level
-  ### or by tags extracted from metric
-  # tags = ["region=us-east", "zone=1c"]
-
-  ### Each template line requires a template pattern.  It can have an optional
-  ### filter before the template and separated by spaces.  It can also have optional extra
-  ### tags following the template.  Multiple tags should be separated by commas and no spaces
-  ### similar to the line protocol format.  There can be only one default template.
-  # templates = [
-  #   "*.app env.service.resource.measurement",
-  #   # Default template
-  #   "server.*",
-  # ]
-
-###
-### [collectd]
-###
-### Controls one or many listeners for collectd data.
-###
-
-[[collectd]]
-  # enabled = false
-  # bind-address = ":25826"
-  # database = "collectd"
-  # retention-policy = ""
-  #
-  # The collectd service supports either scanning a directory for multiple types
-  # db files, or specifying a single db file.
-  # typesdb = "/usr/local/share/collectd"
-  #
-  # security-level = "none"
-  # auth-file = "/etc/collectd/auth_file"
-
-  # These next lines control how batching works. You should have this enabled
-  # otherwise you could get dropped metrics or poor performance. Batching
-  # will buffer points in memory if you have many coming in.
-
-  # Flush if this many points get buffered
-  # batch-size = 5000
-
-  # Number of batches that may be pending in memory
-  # batch-pending = 10
-
-  # Flush at least this often even if we haven't hit buffer limit
-  # batch-timeout = "10s"
-
-  # UDP Read buffer size, 0 means OS default. UDP listener will fail if set above OS max.
-  # read-buffer = 0
-
-  # Multi-value plugins can be handled two ways.
-  # "split" will parse and store the multi-value plugin data into separate measurements
-  # "join" will parse and store the multi-value plugin as a single multi-value measurement.
-  # "split" is the default behavior for backward compatability with previous versions of influxdb.
-  # parse-multivalue-plugin = "split"
-###
-### [opentsdb]
-###
-### Controls one or many listeners for OpenTSDB data.
-###
-
-[[opentsdb]]
-  # enabled = false
-  # bind-address = ":4242"
-  # database = "opentsdb"
-  # retention-policy = ""
-  # consistency-level = "one"
-  # tls-enabled = false
-  # certificate= "/etc/ssl/influxdb.pem"
-
-  # Log an error for every malformed point.
-  # log-point-errors = true
-
-  # These next lines control how batching works. You should have this enabled
-  # otherwise you could get dropped metrics or poor performance. Only points
-  # metrics received over the telnet protocol undergo batching.
-
-  # Flush if this many points get buffered
-  # batch-size = 1000
-
-  # Number of batches that may be pending in memory
-  # batch-pending = 5
-
-  # Flush at least this often even if we haven't hit buffer limit
-  # batch-timeout = "1s"
-
-###
-### [[udp]]
-###
-### Controls the listeners for InfluxDB line protocol data via UDP.
-###
-
-[[udp]]
-  # enabled = false
-  # bind-address = ":8089"
-  # database = "udp"
-  # retention-policy = ""
-
-  # InfluxDB precision for timestamps on received points ("" or "n", "u", "ms", "s", "m", "h")
-  # precision = ""
-
-  # These next lines control how batching works. You should have this enabled
-  # otherwise you could get dropped metrics or poor performance. Batching
-  # will buffer points in memory if you have many coming in.
-
-  # Flush if this many points get buffered
-  # batch-size = 5000
-
-  # Number of batches that may be pending in memory
-  # batch-pending = 10
-
-  # Will flush at least this often even if we haven't hit buffer limit
-  # batch-timeout = "1s"
-
-  # UDP Read buffer size, 0 means OS default. UDP listener will fail if set above OS max.
-  # read-buffer = 0
-
-###
-### [continuous_queries]
-###
-### Controls how continuous queries are run within InfluxDB.
-###
-
-[continuous_queries]
-  # Determines whether the continuous query service is enabled.
-  # enabled = true
-
-  # Controls whether queries are logged when executed by the CQ service.
-  # log-enabled = true
-
-  # Controls whether queries are logged to the self-monitoring data store.
-  # query-stats-enabled = false
-
-  # interval for how often continuous queries will be checked if they need to run
-  # run-interval = "1s"
-
-###
-### [tls]
-###
-### Global configuration settings for TLS in InfluxDB.
-###
-
-[tls]
-  # Determines the available set of cipher suites. See https://golang.org/pkg/crypto/tls/#pkg-constants
-  # for a list of available ciphers, which depends on the version of Go (use the query
-  # SHOW DIAGNOSTICS to see the version of Go used to build InfluxDB). If not specified, uses
-  # the default settings from Go's crypto/tls package.
-  # ciphers = [
-  #   "TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305",
-  #   "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
-  # ]
-
-  # Minimum version of the tls protocol that will be negotiated. If not specified, uses the
-  # default settings from Go's crypto/tls package.
-  # min-version = "tls1.2"
-
-  # Maximum version of the tls protocol that will be negotiated. If not specified, uses the
-  # default settings from Go's crypto/tls package.
-  # max-version = "tls1.2"
+  log-enabled = false
+  write-tracing = false
+  
\ No newline at end of file

changed: [davidayson8-3]
 __________________________________________________________
/ TASK [influxdb : Ensure InfluxDB Exporter is started and \
\ running]                                                 /
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 __________________________________________________________
< TASK [influxdb : Create /home/backup/influxdb directory] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,6 +1,6 @@
 {
-    "group": 0,
-    "owner": 0,
+    "group": 34,
+    "owner": 34,
     "path": "/home/backup/influxdb",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-3]
 ______________________________________
< TASK [influxdb : Create cron backup] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp6qqxup3m/influxdb.backup.cron.j2
@@ -0,0 +1,2 @@
+10 22 * * * backup rm -rf /home/backup/influxdb/* && influxd backup -portable -database telegraf /home/backup/influxdb
+15 22 * * * backup duplicity --no-encryption full /home/backup/influxdb/ rsync://davidayson8@backup/influxdb

changed: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 _______________________________________________
< RUNNING HANDLER [influxdb : Restart InfluxDB] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 _______________________________________________
< RUNNING HANDLER [influxdb : Restart Telegraf] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 ________________________________________________
< RUNNING HANDLER [influxdb : Restart Systemctl] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ___________________________________________
< RUNNING HANDLER [influxdb : Restart cron] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 ____________________
< PLAY [Agama setup] >
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________
< TASK [agama : Make Agama Directory] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/agama",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-2]
--- before
+++ after
@@ -1,4 +1,4 @@
 {
     "path": "/opt/agama",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-1]
 __________________________________________
< TASK [agama : Install agama application] >
 ------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ______________________________________
< TASK [agama : Download docker agama] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ___________________________________
< TASK [agama : Build Docker Image] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
 ______________________________________________
< TASK [agama : Create Data Container for VM1] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2]
changed: [davidayson8-1] => (item=None)
changed: [davidayson8-1] => (item=None)
changed: [davidayson8-1] => (item=None)
changed: [davidayson8-1]
 ______________________________________________
< TASK [agama : Create Data Container for VM2] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1]
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2] => (item=None)
changed: [davidayson8-2]
 _________________________
< PLAY [Web server setup] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
ok: [davidayson8-3]
 _________________________________________
< TASK [nginx : Install Nginx web server] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following additional packages will be installed:
  fontconfig-config fonts-dejavu-core libdeflate0 libfontconfig1 libgd3
  libjbig0 libjpeg-turbo8 libjpeg8 libnginx-mod-http-geoip2
  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
  libnginx-mod-mail libnginx-mod-stream libnginx-mod-stream-geoip2 libtiff5
  libwebp7 libxpm4 nginx-common nginx-core
Suggested packages:
  libgd-tools fcgiwrap nginx-doc ssl-cert
The following NEW packages will be installed:
  fontconfig-config fonts-dejavu-core libdeflate0 libfontconfig1 libgd3
  libjbig0 libjpeg-turbo8 libjpeg8 libnginx-mod-http-geoip2
  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
  libnginx-mod-mail libnginx-mod-stream libnginx-mod-stream-geoip2 libtiff5
  libwebp7 libxpm4 nginx nginx-common nginx-core
0 upgraded, 20 newly installed, 0 to remove and 133 not upgraded.
changed: [davidayson8-3]
The following additional packages will be installed:
  fontconfig-config fonts-dejavu-core libdeflate0 libfontconfig1 libgd3
  libjbig0 libjpeg-turbo8 libjpeg8 libnginx-mod-http-geoip2
  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
  libnginx-mod-mail libnginx-mod-stream libnginx-mod-stream-geoip2 libtiff5
  libwebp7 libxpm4 nginx-common nginx-core
Suggested packages:
  libgd-tools fcgiwrap nginx-doc ssl-cert
The following NEW packages will be installed:
  fontconfig-config fonts-dejavu-core libdeflate0 libfontconfig1 libgd3
  libjbig0 libjpeg-turbo8 libjpeg8 libnginx-mod-http-geoip2
  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
  libnginx-mod-mail libnginx-mod-stream libnginx-mod-stream-geoip2 libtiff5
  libwebp7 libxpm4 nginx nginx-common nginx-core
0 upgraded, 20 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
The following additional packages will be installed:
  fontconfig-config fonts-dejavu-core libdeflate0 libfontconfig1 libgd3
  libjbig0 libjpeg-turbo8 libjpeg8 libnginx-mod-http-geoip2
  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
  libnginx-mod-mail libnginx-mod-stream libnginx-mod-stream-geoip2 libtiff5
  libwebp7 libxpm4 nginx-common nginx-core
Suggested packages:
  libgd-tools fcgiwrap nginx-doc ssl-cert
The following NEW packages will be installed:
  fontconfig-config fonts-dejavu-core libdeflate0 libfontconfig1 libgd3
  libjbig0 libjpeg-turbo8 libjpeg8 libnginx-mod-http-geoip2
  libnginx-mod-http-image-filter libnginx-mod-http-xslt-filter
  libnginx-mod-mail libnginx-mod-stream libnginx-mod-stream-geoip2 libtiff5
  libwebp7 libxpm4 nginx nginx-common nginx-core
0 upgraded, 20 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
 _____________________________________
< TASK [nginx : default Nginx config] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before: /etc/nginx/sites-enabled/default
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpsfvh0lxl/default.j2
@@ -1,91 +1,25 @@
-##
-# You should look at the following URL's in order to grasp a solid understanding
-# of Nginx configuration files in order to fully unleash the power of Nginx.
-# https://www.nginx.com/resources/wiki/start/
-# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/
-# https://wiki.debian.org/Nginx/DirectoryStructure
-#
-# In most cases, administrators will remove this file from sites-enabled/ and
-# leave it as reference inside of sites-available where it will continue to be
-# updated by the nginx packaging team.
-#
-# This file will automatically load configuration files provided by other
-# applications, such as Drupal or Wordpress. These applications will be made
-# available underneath a path with that package name, such as /drupal8.
-#
-# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
-##
+server {
+    listen 80 default_server;
+    server_name _;
 
-# Default server configuration
-#
+    
+        location /prometheus {
+        proxy_pass http://localhost:9090/prometheus;
+    }
+    
+        location /grafana {
+        proxy_set_header Host $http_host;
+        proxy_pass http://localhost:3001;
+    
+    }
+    }
 server {
-	listen 80 default_server;
-	listen [::]:80 default_server;
-
-	# SSL configuration
-	#
-	# listen 443 ssl default_server;
-	# listen [::]:443 ssl default_server;
-	#
-	# Note: You should disable gzip for SSL traffic.
-	# See: https://bugs.debian.org/773332
-	#
-	# Read up on ssl_ciphers to ensure a secure configuration.
-	# See: https://bugs.debian.org/765782
-	#
-	# Self signed certs generated by the ssl-cert package
-	# Don't use them in a production server!
-	#
-	# include snippets/snakeoil.conf;
-
-	root /var/www/html;
-
-	# Add index.php to the list if you are using PHP
-	index index.html index.htm index.nginx-debian.html;
-
-	server_name _;
-
-	location / {
-		# First attempt to serve request as file, then
-		# as directory, then fall back to displaying a 404.
-		try_files $uri $uri/ =404;
-	}
-
-	# pass PHP scripts to FastCGI server
-	#
-	#location ~ \.php$ {
-	#	include snippets/fastcgi-php.conf;
-	#
-	#	# With php-fpm (or other unix sockets):
-	#	fastcgi_pass unix:/run/php/php7.4-fpm.sock;
-	#	# With php-cgi (or other tcp sockets):
-	#	fastcgi_pass 127.0.0.1:9000;
-	#}
-
-	# deny access to .htaccess files, if Apache's document root
-	# concurs with nginx's one
-	#
-	#location ~ /\.ht {
-	#	deny all;
-	#}
+    listen 8080 default_server;
+    
+    location /stub_status {
+        stub_status;
+        allow 127.0.0.1;
+        deny all;
+    }
 }
 
-
-# Virtual Host configuration for example.com
-#
-# You can move that to a different file under sites-available/ and symlink that
-# to sites-enabled/ to enable it.
-#
-#server {
-#	listen 80;
-#	listen [::]:80;
-#
-#	server_name example.com;
-#
-#	root /var/www/example.com;
-#	index index.html;
-#
-#	location / {
-#		try_files $uri $uri/ =404;
-#	}
-#}

changed: [davidayson8-3]
--- before: /etc/nginx/sites-enabled/default
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpz0pfsjwo/default.j2
@@ -1,91 +1,21 @@
-##
-# You should look at the following URL's in order to grasp a solid understanding
-# of Nginx configuration files in order to fully unleash the power of Nginx.
-# https://www.nginx.com/resources/wiki/start/
-# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/
-# https://wiki.debian.org/Nginx/DirectoryStructure
-#
-# In most cases, administrators will remove this file from sites-enabled/ and
-# leave it as reference inside of sites-available where it will continue to be
-# updated by the nginx packaging team.
-#
-# This file will automatically load configuration files provided by other
-# applications, such as Drupal or Wordpress. These applications will be made
-# available underneath a path with that package name, such as /drupal8.
-#
-# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
-##
+server {
+    listen 80 default_server;
+    server_name _;
 
-# Default server configuration
-#
+        location / {
+        proxy_pass http://localhost:8001;
+        proxy_set_header Host $http_host;
+    }
+    
+    
+    }
 server {
-	listen 80 default_server;
-	listen [::]:80 default_server;
-
-	# SSL configuration
-	#
-	# listen 443 ssl default_server;
-	# listen [::]:443 ssl default_server;
-	#
-	# Note: You should disable gzip for SSL traffic.
-	# See: https://bugs.debian.org/773332
-	#
-	# Read up on ssl_ciphers to ensure a secure configuration.
-	# See: https://bugs.debian.org/765782
-	#
-	# Self signed certs generated by the ssl-cert package
-	# Don't use them in a production server!
-	#
-	# include snippets/snakeoil.conf;
-
-	root /var/www/html;
-
-	# Add index.php to the list if you are using PHP
-	index index.html index.htm index.nginx-debian.html;
-
-	server_name _;
-
-	location / {
-		# First attempt to serve request as file, then
-		# as directory, then fall back to displaying a 404.
-		try_files $uri $uri/ =404;
-	}
-
-	# pass PHP scripts to FastCGI server
-	#
-	#location ~ \.php$ {
-	#	include snippets/fastcgi-php.conf;
-	#
-	#	# With php-fpm (or other unix sockets):
-	#	fastcgi_pass unix:/run/php/php7.4-fpm.sock;
-	#	# With php-cgi (or other tcp sockets):
-	#	fastcgi_pass 127.0.0.1:9000;
-	#}
-
-	# deny access to .htaccess files, if Apache's document root
-	# concurs with nginx's one
-	#
-	#location ~ /\.ht {
-	#	deny all;
-	#}
+    listen 8080 default_server;
+    
+    location /stub_status {
+        stub_status;
+        allow 127.0.0.1;
+        deny all;
+    }
 }
 
-
-# Virtual Host configuration for example.com
-#
-# You can move that to a different file under sites-available/ and symlink that
-# to sites-enabled/ to enable it.
-#
-#server {
-#	listen 80;
-#	listen [::]:80;
-#
-#	server_name example.com;
-#
-#	root /var/www/example.com;
-#	index index.html;
-#
-#	location / {
-#		try_files $uri $uri/ =404;
-#	}
-#}

changed: [davidayson8-2]
--- before: /etc/nginx/sites-enabled/default
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmp3a83bkq1/default.j2
@@ -1,91 +1,21 @@
-##
-# You should look at the following URL's in order to grasp a solid understanding
-# of Nginx configuration files in order to fully unleash the power of Nginx.
-# https://www.nginx.com/resources/wiki/start/
-# https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/
-# https://wiki.debian.org/Nginx/DirectoryStructure
-#
-# In most cases, administrators will remove this file from sites-enabled/ and
-# leave it as reference inside of sites-available where it will continue to be
-# updated by the nginx packaging team.
-#
-# This file will automatically load configuration files provided by other
-# applications, such as Drupal or Wordpress. These applications will be made
-# available underneath a path with that package name, such as /drupal8.
-#
-# Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.
-##
+server {
+    listen 80 default_server;
+    server_name _;
 
-# Default server configuration
-#
+        location / {
+        proxy_pass http://localhost:8001;
+        proxy_set_header Host $http_host;
+    }
+    
+    
+    }
 server {
-	listen 80 default_server;
-	listen [::]:80 default_server;
-
-	# SSL configuration
-	#
-	# listen 443 ssl default_server;
-	# listen [::]:443 ssl default_server;
-	#
-	# Note: You should disable gzip for SSL traffic.
-	# See: https://bugs.debian.org/773332
-	#
-	# Read up on ssl_ciphers to ensure a secure configuration.
-	# See: https://bugs.debian.org/765782
-	#
-	# Self signed certs generated by the ssl-cert package
-	# Don't use them in a production server!
-	#
-	# include snippets/snakeoil.conf;
-
-	root /var/www/html;
-
-	# Add index.php to the list if you are using PHP
-	index index.html index.htm index.nginx-debian.html;
-
-	server_name _;
-
-	location / {
-		# First attempt to serve request as file, then
-		# as directory, then fall back to displaying a 404.
-		try_files $uri $uri/ =404;
-	}
-
-	# pass PHP scripts to FastCGI server
-	#
-	#location ~ \.php$ {
-	#	include snippets/fastcgi-php.conf;
-	#
-	#	# With php-fpm (or other unix sockets):
-	#	fastcgi_pass unix:/run/php/php7.4-fpm.sock;
-	#	# With php-cgi (or other tcp sockets):
-	#	fastcgi_pass 127.0.0.1:9000;
-	#}
-
-	# deny access to .htaccess files, if Apache's document root
-	# concurs with nginx's one
-	#
-	#location ~ /\.ht {
-	#	deny all;
-	#}
+    listen 8080 default_server;
+    
+    location /stub_status {
+        stub_status;
+        allow 127.0.0.1;
+        deny all;
+    }
 }
 
-
-# Virtual Host configuration for example.com
-#
-# You can move that to a different file under sites-available/ and symlink that
-# to sites-enabled/ to enable it.
-#
-#server {
-#	listen 80;
-#	listen [::]:80;
-#
-#	server_name example.com;
-#
-#	root /var/www/example.com;
-#	index index.html;
-#
-#	location / {
-#		try_files $uri $uri/ =404;
-#	}
-#}

changed: [davidayson8-1]
 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _________________________________________
< RUNNING HANDLER [nginx : Restart nginx] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-2]
changed: [davidayson8-1]
changed: [davidayson8-3]
 _____________________________________________________
/ TASK [nginx : Ensure Nginx services are started and \
\ enabled]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________
< TASK [nginx : Install Nginx Exporter] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following NEW packages will be installed:
  prometheus-nginx-exporter
0 upgraded, 1 newly installed, 0 to remove and 133 not upgraded.
changed: [davidayson8-3]
The following NEW packages will be installed:
  prometheus-nginx-exporter
0 upgraded, 1 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-1]
The following NEW packages will be installed:
  prometheus-nginx-exporter
0 upgraded, 1 newly installed, 0 to remove and 131 not upgraded.
changed: [davidayson8-2]
 ___________________________________________________________
/ TASK [nginx : Ensure Prometheus-nginx-exporter is started \
\ and enabled]                                              /
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2, davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
changed: [davidayson8-2]
changed: [davidayson8-1]
 ___________________________
< PLAY [Agama-Client setup] >
 ---------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________
< TASK [agama_client : Install fping] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

The following NEW packages will be installed:
  fping
0 upgraded, 1 newly installed, 0 to remove and 133 not upgraded.
changed: [davidayson8-3]
 ________________________________________________
< TASK [agama_client : Create agama-client user] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 _____________________________________________________
< TASK [agama_client : Create agama-client directory] >
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after
@@ -1,5 +1,5 @@
 {
-    "owner": 0,
+    "owner": 1001,
     "path": "/etc/agama-client",
-    "state": "absent"
+    "state": "directory"
 }

changed: [davidayson8-3]
 _______________________________________________
< TASK [agama_client : Copy agama-client files] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpc1yfyscb/agama-client
@@ -0,0 +1,71 @@
+#!/bin/bash -eu
+
+# Please help Dora to find problems in this script
+
+for t in database_url database_name subnet; do
+    if ! grep -q "^${t}=" /etc/agama-client/agama-client.conf; then
+        logger "$0 Failed to get $t from config"
+        exit 1
+    fi
+done
+
+which fping > /dev/null || { logger "$0 fping not found"; exit 1; }
+
+logger "Starting agama-client..."
+
+db_url=$(grep "^database_url=" /etc/agama-client/agama-client.conf | sed 's/^.*=//')
+db_name=$(grep "^database_name=" /etc/agama-client/agama-client.conf | sed 's/^.*=//')
+subnet=$(grep "^subnet=" /etc/agama-client/agama-client.conf | sed 's/^.*=//')
+
+for i in {1..30}; do
+    if $(curl -s "$db_url/ping"); then
+        logger "Will push data to $db_url"
+        break
+    else
+        logger "Failed to connect to $db_url. InfluxDB is not running? ($i)"
+        sleep 5
+    fi
+done
+
+logger "Creating database $db_name in $db_url"
+curl -i -XPOST "$db_url/query" --data-urlencode "q=CREATE DATABASE $db_name" 1>/dev/null 2>/dev/null || { logger "$0 Failed to create database"; exit 1; }
+
+while true; do
+    alive_hosts=$(fping -g $subnet -a 2>/dev/null || true)
+    logger "Discovered $(echo "$alive_hosts" | wc -l) IPs"
+    for vm_ip in $alive_hosts; do
+        # Getting content of agama page
+        content=$(curl --connect-timeout 1 -w "%{http_code}" -s $vm_ip || continue)
+        if test ${content: -3} -ne 200; then
+            # nothing to do, going to next student
+            continue
+        fi
+        # Getting where it's hosted
+        vm_name=$(echo "$content" | grep "running on" | awk '{print $5}')
+        if [ -z $vm_name ]; then
+            # No agama running, skipping
+            continue
+        fi
+        ptr=$(host -W1 $vm_ip $vm_ip | awk '/domain name pointer/ {print $5}')
+        if ! [ -z "$ptr" ]; then
+            logger "Resolved $vm_ip to $ptr"
+            vm_name="$ptr"
+        fi
+        # Number of items in agama
+        table_rows=$(echo "$content" | grep -c "</tr>")
+        # Write stats to inflixdb
+        curl -i -XPOST "${db_url}/write?db=$db_name" --data-binary "agama-stats,name=$vm_name items=$table_rows" 1>/dev/null 2>/dev/null
+        # If hostname exists in agama - delete it
+        if $(echo "$content" | grep -q $(hostname)); then
+            for delete_url in $(echo "$content" | grep $(hostname) | grep -o '/items/.*/swap-state' | sed 's/swap-state/delete/'); do
+                curl -s $vm_ip$delete_url -o /dev/null || logger "Failed to delete $(hostname) from $vm_ip"
+            done
+        fi
+        # Add new item to agama
+        curl -s -XPOST $vm_ip/items/add -F new_item="Checked from $(hostname) at $(date)" -o /dev/null || logger "Failed to update Agama on $vm_ip"
+        logger "Posted check message to $vm_ip"
+    done
+    logger "Waiting for the next cycle to start..."
+    sleep 300
+done
+

changed: [davidayson8-3]
 _________________________________________________
< TASK [agama_client : Copy agama-client service] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmpra90hb71/agama-client.service
@@ -0,0 +1,11 @@
+[Unit]
+Description=Agama Client
+Documentation=https://github.com/hudolejev/agama
+After=network-online.target
+
+[Service]
+User=agama-client
+ExecStart=/usr/local/bin/agama-client
+
+[Install]
+WantedBy=multi-user.target

changed: [davidayson8-3]
 ________________________________________________
< TASK [agama_client : Copy agama-client config] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

--- before
+++ after: /home/daayso/.ansible/tmp/ansible-local-1055530xohr3ys/tmparxg7brq/agama-client.conf
@@ -0,0 +1,3 @@
+database_url=http://influxdb:8086
+database_name=agamaDB
+subnet=192.168.42.0/23

changed: [davidayson8-3]
 _____________________________________________________________
/ TASK [agama_client : Ensure agama-client service is started \
\ and enabled]                                                /
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

changed: [davidayson8-3]
 _________________________________________________
< RUNNING HANDLER [agama_client : Reload systemd] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________
< PLAY RECAP >
 ------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

davidayson8-1              : ok=98   changed=74   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
davidayson8-2              : ok=98   changed=74   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
davidayson8-3              : ok=103  changed=73   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

+ ansible-playbook infra.yaml --diff
[WARNING]: While constructing a mapping from
/home/daayso/ica0002/ica0002/roles/agama/tasks/main.yaml, line 27, column 5,
found a duplicate dict key (state). Using last defined value only.
[WARNING]: While constructing a mapping from
/home/daayso/ica0002/ica0002/roles/agama/tasks/main.yaml, line 42, column 5,
found a duplicate dict key (state). Using last defined value only.
 ______________________
< PLAY [Initial setup] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

[WARNING]: Platform linux on host davidayson8-3 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
[WARNING]: Platform linux on host davidayson8-2 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
[WARNING]: Platform linux on host davidayson8-1 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ________________________________
< TASK [init : Update APT cache] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
ok: [davidayson8-3]
 _______________________________________
< TASK [init : Install Prometheus node] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 ____________________________________
< TASK [init : Run Rsyslog template] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 __________________________________
< TASK [init : Create backup user] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ____________________________________
< TASK [init : Generate SSH keypair] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ____________________________________________________________
< TASK [init : Ensure .ssh directory exists for backup user] >
 ------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________________________
/ TASK [init : Add backup server key to known_hosts for \
\ backup user]                                          /
 -------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________________
< TASK [init : Make Backup owner of INIT DIR] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 _________________________________
< TASK [init : Install Duplicity] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
ok: [davidayson8-3]
 _________________________
< PLAY [host DNS servers] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 _____________________________
< TASK [bind : Install Bind9] >
 -----------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ___________________________________________________
< TASK [bind : Configure named.conf files Template] >
 ---------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3] => (item=None)
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-3] => (item=None)
ok: [davidayson8-3]
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2]
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1]
 _________________________________
< TASK [bind : Run Zone template] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
ok: [davidayson8-3]
 _________________________________________
< TASK [bind : Run Reverse Zone template] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1]
skipping: [davidayson8-2]
ok: [davidayson8-3]
 _______________________________________________
< TASK [bind : Install dependency for nsupdate] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________________________________
< TASK [bind : Add backup record on backup DNS servers] >
 -------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ___________________________________________________________
< TASK [bind : Ensure Bind9 service is started and running] >
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________________________
< TASK [bind : Create bind_exporter user] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 _______________________________________
< TASK [bind : Download Bind9 exporter] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 __________________________________________________
< TASK [bind : Create directory for Bind Exporter] >
 --------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________________________
< TASK [bind : Extract Bind9 exporter] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________________________
/ TASK [bind : Create a symlink for the Bind Exporter \
\ executable]                                         /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________________________
< TASK [bind : Create Bind9 exporter systemd service] >
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 ___________________________________________________________
/ TASK [bind : Ensure Bind9 exporter service is started and \
\ running]                                                  /
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3, davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________
< PLAY [Setup custom DNS] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________________________
< TASK [resolver : Update resolv.conf] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________________
< TASK [resolver : System-resolved is shutdown] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ___________________________
< PLAY [Install Prometheus] >
 ---------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________
< TASK [prometheus : Install Prometheus] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________________
/ TASK [prometheus : Make sure Prometheus is enabled and \
\ running]                                               /
 --------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________________________
< TASK [prometheus : Run Prometheus config template] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
< TASK [prometheus : Run Prometheus Web External Template] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________
< PLAY [Keepalived setup] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________________
< TASK [keepalived : Make Keepalived Directory] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ________________________________________
< TASK [keepalived : Install Keepalived] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________________________________
< TASK [keepalived : Create keepalived_script] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________
< TASK [keepalived : Keepalived script] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________
< TASK [keepalived : Keepalived Config] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________________________
/ TASK [keepalived : Ensure Keepalived is enabled and \
\ started]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 __________________________________________________________
< TASK [keepalived : Download Keepalived exporter package] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________________________________
< TASK [keepalived : Unarchive Keepalived exporter package] >
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1]
skipping: [davidayson8-2]
 _________________________________________________
< TASK [keepalived : Keepalived Exporter Service] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________________________
/ TASK [keepalived : Ensure Keepalived is enabled and \
\ started]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________
< PLAY [Haproxy Setup] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 __________________________________
< TASK [haproxy : Install Haproxy] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________
< TASK [haproxy : Haproxy Config] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ___________________________________________
< TASK [haproxy : Install Haproxy Exporter] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________________
< TASK [haproxy : Haproxy Exporter config] >
 ------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________
< PLAY [Docker Setup] >
 ---------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________________________________
< TASK [docker : Install docker and Resources] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ________________________
< PLAY [Install Grafana] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________
< TASK [grafana : Create Grafana directories] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3] => (item=dashboards)
ok: [davidayson8-3] => (item=datasources)
 _________________________________
< TASK [grafana : Copy main.json] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________
< TASK [grafana : Copy backups.json] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ___________________________________
< TASK [grafana : Copy syslog.json] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________
< TASK [grafana : Copy mysql.json] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________________
< TASK [grafana : Dashboards template] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _______________________________________
< TASK [grafana : Datasources template] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ___________________________________
< TASK [grafana : Grafana Template] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________
< TASK [grafana : Create Grafana data container] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________
< PLAY [Database server setup] >
 ------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________
< TASK [mysql : Install MySQL server] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ________________________________________________
< TASK [mysql : Add MySQL bind address override] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ____________________________________________________
< TASK [mysql : Ensure MySQL is running and enabled] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________
< TASK [mysql : MySQL database] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 __________________________________
< TASK [mysql : Create MySQL user] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________________
< TASK [mysql : Create MySQL Exporter user] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ____________________________________________________
/ TASK [mysql : Passing authentication data to MySQL \
\ Exporter]                                          /
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________________________________
< TASK [mysql : Run prometheus exporter template] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________________________________
< TASK [mysql : Ensure the MySQL Exporter service is started] >
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ____________________________________________________
< TASK [mysql : Create /home/backup/mysql directory] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________________
< TASK [mysql : Ensure MySQL backup user exist] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________
< TASK [mysql : Create backup template] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ___________________________________
< TASK [mysql : Create Cron Backup] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ____________________________________________________
< TASK [mysql : Ensure MySQL replication user exist] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________________________________
< TASK [mysql : Handles dynamic MySQL parameters] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________
< PLAY [InfluxDB] >
 -----------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________
< TASK [influxdb : Install InfluxDB] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
< TASK [influxdb : Ensure InfluxDB is started and enabled] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________
< TASK [influxdb : Make dir for apt key] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________
< TASK [influxdb : Install Telegraf Repo Key] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________
< TASK [influxdb : Add Telegraf Repo] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________
< TASK [influxdb : Install Telegraf] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________
< TASK [influxdb : Run Telegraf template] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________________________
< TASK [influxdb : Make sure Telegraf is enabled and running] >
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________
< TASK [influxdb : Install InfluxDB Stat Exporter] >
 --------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________________________________
< TASK [influxdb : Import Influxdb Stat Expo Template] >
 ------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [influxdb : Import Influxdb Conf Template] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
/ TASK [influxdb : Ensure InfluxDB Exporter is started and \
\ running]                                                 /
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
< TASK [influxdb : Create /home/backup/influxdb directory] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________________
< TASK [influxdb : Create cron backup] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________
< PLAY [Agama setup] >
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 _____________________________________
< TASK [agama : Make Agama Directory] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________________
< TASK [agama : Install agama application] >
 ------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________________________
< TASK [agama : Download docker agama] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ___________________________________
< TASK [agama : Build Docker Image] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________________________________
< TASK [agama : Create Data Container for VM1] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2]
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1]
 ______________________________________________
< TASK [agama : Create Data Container for VM2] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1]
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2]
 _________________________
< PLAY [Web server setup] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-3]
ok: [davidayson8-1]
 _________________________________________
< TASK [nginx : Install Nginx web server] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________
< TASK [nginx : default Nginx config] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _____________________________________________________
/ TASK [nginx : Ensure Nginx services are started and \
\ enabled]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________
< TASK [nginx : Install Nginx Exporter] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ___________________________________________________________
/ TASK [nginx : Ensure Prometheus-nginx-exporter is started \
\ and enabled]                                              /
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2, davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________
< PLAY [Agama-Client setup] >
 ---------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________
< TASK [agama_client : Install fping] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________
< TASK [agama_client : Create agama-client user] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________________
< TASK [agama_client : Create agama-client directory] >
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _______________________________________________
< TASK [agama_client : Copy agama-client files] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [agama_client : Copy agama-client service] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________
< TASK [agama_client : Copy agama-client config] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________________________
/ TASK [agama_client : Ensure agama-client service is started \
\ and enabled]                                                /
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________
< PLAY RECAP >
 ------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

davidayson8-1              : ok=83   changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
davidayson8-2              : ok=83   changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
davidayson8-3              : ok=89   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

+ ansible all -b -m reboot -a test_command=uptime
davidayson8-3 | CHANGED => {
    "changed": true,
    "elapsed": 49,
    "rebooted": true
}
davidayson8-1 | CHANGED => {
    "changed": true,
    "elapsed": 57,
    "rebooted": true
}
davidayson8-2 | CHANGED => {
    "changed": true,
    "elapsed": 57,
    "rebooted": true
}
+ sleep 15
+ ansible-playbook infra.yaml --diff
[WARNING]: While constructing a mapping from
/home/daayso/ica0002/ica0002/roles/agama/tasks/main.yaml, line 27, column 5,
found a duplicate dict key (state). Using last defined value only.
[WARNING]: While constructing a mapping from
/home/daayso/ica0002/ica0002/roles/agama/tasks/main.yaml, line 42, column 5,
found a duplicate dict key (state). Using last defined value only.
 ______________________
< PLAY [Initial setup] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

[WARNING]: Platform linux on host davidayson8-3 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
[WARNING]: Platform linux on host davidayson8-1 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
[WARNING]: Platform linux on host davidayson8-2 is using the discovered Python
interpreter at /usr/bin/python3.10, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.17/reference_appendices/interpreter_discovery.html for more information.
ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ________________________________
< TASK [init : Update APT cache] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _______________________________________
< TASK [init : Install Prometheus node] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ____________________________________
< TASK [init : Run Rsyslog template] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 __________________________________
< TASK [init : Create backup user] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ____________________________________
< TASK [init : Generate SSH keypair] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
ok: [davidayson8-3]
 ____________________________________________________________
< TASK [init : Ensure .ssh directory exists for backup user] >
 ------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
ok: [davidayson8-3]
 _______________________________________________________
/ TASK [init : Add backup server key to known_hosts for \
\ backup user]                                          /
 -------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
ok: [davidayson8-3]
 _____________________________________________
< TASK [init : Make Backup owner of INIT DIR] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _________________________________
< TASK [init : Install Duplicity] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-2]
ok: [davidayson8-1]
 _________________________
< PLAY [host DNS servers] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _____________________________
< TASK [bind : Install Bind9] >
 -----------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________________________
< TASK [bind : Configure named.conf files Template] >
 ---------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1] => (item=None)
ok: [davidayson8-3] => (item=None)
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1]
ok: [davidayson8-3] => (item=None)
ok: [davidayson8-3]
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2]
 _________________________________
< TASK [bind : Run Zone template] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _________________________________________
< TASK [bind : Run Reverse Zone template] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1]
skipping: [davidayson8-2]
ok: [davidayson8-3]
 _______________________________________________
< TASK [bind : Install dependency for nsupdate] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________________
< TASK [bind : Execute handlers] >
 --------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________________________________
< TASK [bind : Add backup record on backup DNS servers] >
 -------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ___________________________________________________________
< TASK [bind : Ensure Bind9 service is started and running] >
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________
< TASK [bind : Create bind_exporter user] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _______________________________________
< TASK [bind : Download Bind9 exporter] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 __________________________________________________
< TASK [bind : Create directory for Bind Exporter] >
 --------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________________________
< TASK [bind : Extract Bind9 exporter] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________________________
/ TASK [bind : Create a symlink for the Bind Exporter \
\ executable]                                         /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _____________________________________________________
< TASK [bind : Create Bind9 exporter systemd service] >
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ___________________________________________________________
/ TASK [bind : Ensure Bind9 exporter service is started and \
\ running]                                                  /
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3, davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________
< PLAY [Setup custom DNS] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ______________________________________
< TASK [resolver : Update resolv.conf] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _______________________________________________
< TASK [resolver : System-resolved is shutdown] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ___________________________
< PLAY [Install Prometheus] >
 ---------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________
< TASK [prometheus : Install Prometheus] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________________
/ TASK [prometheus : Make sure Prometheus is enabled and \
\ running]                                               /
 --------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________________________
< TASK [prometheus : Run Prometheus config template] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
< TASK [prometheus : Run Prometheus Web External Template] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________
< PLAY [Keepalived setup] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________________
< TASK [keepalived : Make Keepalived Directory] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ________________________________________
< TASK [keepalived : Install Keepalived] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________________________________
< TASK [keepalived : Create keepalived_script] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________
< TASK [keepalived : Keepalived script] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________
< TASK [keepalived : Keepalived Config] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________________________
/ TASK [keepalived : Ensure Keepalived is enabled and \
\ started]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________________________________
< TASK [keepalived : Download Keepalived exporter package] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________________________________
< TASK [keepalived : Unarchive Keepalived exporter package] >
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1]
skipping: [davidayson8-2]
 _________________________________________________
< TASK [keepalived : Keepalived Exporter Service] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________________________
/ TASK [keepalived : Ensure Keepalived is enabled and \
\ started]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________
< PLAY [Haproxy Setup] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________
< TASK [haproxy : Install Haproxy] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________
< TASK [haproxy : Haproxy Config] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________________
< TASK [haproxy : Install Haproxy Exporter] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________________
< TASK [haproxy : Haproxy Exporter config] >
 ------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________
< PLAY [Docker Setup] >
 ---------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ______________________________________________
< TASK [docker : Install docker and Resources] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ________________________
< PLAY [Install Grafana] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________
< TASK [grafana : Create Grafana directories] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3] => (item=dashboards)
ok: [davidayson8-3] => (item=datasources)
 _________________________________
< TASK [grafana : Copy main.json] >
 ---------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________
< TASK [grafana : Copy backups.json] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ___________________________________
< TASK [grafana : Copy syslog.json] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________
< TASK [grafana : Copy mysql.json] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________________
< TASK [grafana : Dashboards template] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _______________________________________
< TASK [grafana : Datasources template] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ___________________________________
< TASK [grafana : Grafana Template] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________
< TASK [grafana : Create Grafana data container] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________
< PLAY [Database server setup] >
 ------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________
< TASK [mysql : Install MySQL server] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ________________________________________________
< TASK [mysql : Add MySQL bind address override] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ____________________________________________________
< TASK [mysql : Ensure MySQL is running and enabled] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________
< TASK [mysql : MySQL database] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________
< TASK [mysql : Create MySQL user] >
 ----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________________
< TASK [mysql : Create MySQL Exporter user] >
 -------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ____________________________________________________
/ TASK [mysql : Passing authentication data to MySQL \
\ Exporter]                                          /
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [mysql : Run prometheus exporter template] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________________________________
< TASK [mysql : Ensure the MySQL Exporter service is started] >
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ____________________________________________________
< TASK [mysql : Create /home/backup/mysql directory] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________________
< TASK [mysql : Ensure MySQL backup user exist] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________
< TASK [mysql : Create backup template] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________
< TASK [mysql : Create Cron Backup] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ____________________________________________________
< TASK [mysql : Ensure MySQL replication user exist] >
 ----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [mysql : Handles dynamic MySQL parameters] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-2]
ok: [davidayson8-1]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________
< PLAY [InfluxDB] >
 -----------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________
< TASK [influxdb : Install InfluxDB] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
< TASK [influxdb : Ensure InfluxDB is started and enabled] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________
< TASK [influxdb : Make dir for apt key] >
 ----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________
< TASK [influxdb : Install Telegraf Repo Key] >
 ---------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________
< TASK [influxdb : Add Telegraf Repo] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________________________
< TASK [influxdb : Install Telegraf] >
 ------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________
< TASK [influxdb : Run Telegraf template] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________________________
< TASK [influxdb : Make sure Telegraf is enabled and running] >
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________
< TASK [influxdb : Install InfluxDB Stat Exporter] >
 --------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________________________________
< TASK [influxdb : Import Influxdb Stat Expo Template] >
 ------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [influxdb : Import Influxdb Conf Template] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
/ TASK [influxdb : Ensure InfluxDB Exporter is started and \
\ running]                                                 /
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 __________________________________________________________
< TASK [influxdb : Create /home/backup/influxdb directory] >
 ----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________________________
< TASK [influxdb : Create cron backup] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________________
< PLAY [Agama setup] >
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________
< TASK [agama : Make Agama Directory] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 __________________________________________
< TASK [agama : Install agama application] >
 ------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________________________
< TASK [agama : Download docker agama] >
 --------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ___________________________________
< TASK [agama : Build Docker Image] >
 -----------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________________________________
< TASK [agama : Create Data Container for VM1] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2] => (item=None) 
skipping: [davidayson8-2]
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1] => (item=None)
ok: [davidayson8-1]
 ______________________________________________
< TASK [agama : Create Data Container for VM2] >
 ----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1] => (item=None) 
skipping: [davidayson8-1]
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2] => (item=None)
ok: [davidayson8-2]
 _________________________
< PLAY [Web server setup] >
 -------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _________________________________________
< TASK [nginx : Install Nginx web server] >
 -----------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _____________________________________
< TASK [nginx : default Nginx config] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _______________________________
< TASK [nginx : Flush handlers] >
 -------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 _____________________________________________________
/ TASK [nginx : Ensure Nginx services are started and \
\ enabled]                                            /
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _______________________________________
< TASK [nginx : Install Nginx Exporter] >
 ---------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ___________________________________________________________
/ TASK [nginx : Ensure Prometheus-nginx-exporter is started \
\ and enabled]                                              /
 -----------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 ______________________
< TASK [Assign cnames] >
 ----------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

included: cname for davidayson8-1, davidayson8-2, davidayson8-3
 ________________________________________________
< TASK [cname : Install dependency for nsupdate] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
ok: [davidayson8-1]
ok: [davidayson8-2]
 _________________________________________________
< TASK [cname : Add cname record for DNS servers] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-1]
ok: [davidayson8-3]
ok: [davidayson8-2]
 ___________________________
< PLAY [Agama-Client setup] >
 ---------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

 ________________________
< TASK [Gathering Facts] >
 ------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________
< TASK [agama_client : Install fping] >
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________
< TASK [agama_client : Create agama-client user] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________________
< TASK [agama_client : Create agama-client directory] >
 -----------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _______________________________________________
< TASK [agama_client : Copy agama-client files] >
 -----------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _________________________________________________
< TASK [agama_client : Copy agama-client service] >
 -------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ________________________________________________
< TASK [agama_client : Copy agama-client config] >
 ------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 _____________________________________________________________
/ TASK [agama_client : Ensure agama-client service is started \
\ and enabled]                                                /
 -------------------------------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

ok: [davidayson8-3]
 ____________
< PLAY RECAP >
 ------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||

davidayson8-1              : ok=83   changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
davidayson8-2              : ok=83   changed=0    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0   
davidayson8-3              : ok=89   changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

+ date
Sun Jan 19 23:12:17 CET 2025
